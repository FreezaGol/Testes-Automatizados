2025-09-05 08:41:46,668 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 08:41:46,670 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 08:44:46,718 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 08:44:46,718 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 08:44:46,737 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 08:44:46,737 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 08:44:46,738 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 08:44:46,748 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 08:44:48,196 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 08:44:48,196 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 08:44:48,197 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 08:44:48,206 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 08:44:48,207 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 08:44:50,207 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 08:44:50,208 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-05 08:44:50,210 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 08:44:53,684 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 08:44:53,685 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 08:44:58,388 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 08:44:58,391 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:44:58,537 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 08:45:00,078 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 08:45:00,079 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 08:45:01,109 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 08:45:01,135 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 08:45:02,051 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 08:45:02,068 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 08:45:31,963 - INFO - [test_dav_creation:98] - Usuário selecionou 5 itens: ['4', '10', '19', '40', '49']
2025-09-05 08:45:31,965 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 08:45:31,971 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 08:45:31,971 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-05 08:45:34,971 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 08:45:34,978 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 08:45:35,190 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 08:45:35,204 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 08:45:35,231 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 08:45:35,798 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 08:45:36,816 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:45:36,816 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 08:45:37,125 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-05 08:45:37,125 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 08:45:37,127 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:45:37,130 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 08:45:37,145 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 08:45:37,387 - INFO - [test_dav_creation:290] -    -> Cliente '65820' inserido.
2025-09-05 08:45:38,403 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 08:45:39,495 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 08:45:40,587 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-05 08:45:40,588 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-05 08:45:40,588 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 08:45:40,588 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 08:45:40,788 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-05 08:45:41,880 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:45:41,880 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 08:45:41,976 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 08:45:41,977 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-05 08:45:41,994 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 08:45:42,261 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-05 08:45:42,261 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 08:45:42,319 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 08:45:42,819 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 08:45:42,829 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 08:45:42,836 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 08:45:42,836 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-05 08:45:42,837 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 08:45:42,837 - INFO - [test_dav_creation:390] -    -> Lançando produto: 4
2025-09-05 08:45:42,852 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:45:42,855 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 08:45:43,085 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:45:43,507 - INFO - [test_dav_creation:435] - Estoque disponível: 88. Quantidade sorteada: 17
2025-09-05 08:45:43,736 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:45:43,740 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:45:44,377 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:45:47,428 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:45:47,988 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 08:46:08,344 - ERROR - [test_dav_creation:494] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 475, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 08:46:12,219 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 08:46:12,220 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 08:46:12,221 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 08:46:12,225 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 08:46:12,226 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 08:46:13,876 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 08:46:13,877 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-05 08:46:13,878 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 08:46:16,740 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 08:46:16,742 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 08:46:18,829 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 08:46:18,997 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:46:19,005 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 08:46:22,835 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 08:46:22,836 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 08:46:24,024 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 08:46:24,026 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 08:46:25,009 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 08:46:25,011 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 08:46:48,252 - INFO - [test_dav_creation:98] - Usuário selecionou 6 itens: ['8', '9', '16', '19', '30', '32']
2025-09-05 08:46:48,295 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 08:46:48,303 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 08:46:48,303 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-05 08:46:51,304 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 08:46:51,310 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 08:46:51,522 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 08:46:51,536 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 08:46:51,773 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 08:46:52,115 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 08:46:53,176 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:46:53,176 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 08:46:53,467 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-05 08:46:53,467 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 08:46:53,469 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:46:53,472 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 08:46:53,487 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 08:46:53,764 - INFO - [test_dav_creation:290] -    -> Cliente '65820' inserido.
2025-09-05 08:46:54,870 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 08:46:55,962 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 08:46:56,977 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-05 08:46:56,977 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-05 08:46:56,977 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 08:46:56,977 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 08:46:57,084 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-05 08:46:58,175 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:46:58,175 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 08:46:58,271 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 08:46:58,271 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-05 08:46:58,287 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 08:46:58,490 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-05 08:46:58,491 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 08:46:58,549 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 08:46:59,049 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 08:46:59,050 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 08:46:59,053 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 08:46:59,053 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-05 08:46:59,053 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 08:46:59,053 - INFO - [test_dav_creation:390] -    -> Lançando produto: 8
2025-09-05 08:46:59,071 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:46:59,074 - INFO - [test_dav_creation:407] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 08:46:59,345 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:46:59,840 - INFO - [test_dav_creation:435] - Estoque disponível: 484. Quantidade sorteada: 17
2025-09-05 08:47:00,101 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:47:00,106 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:47:00,628 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:47:03,834 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:47:04,422 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 08:47:12,014 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-05 08:47:13,214 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 08:47:13,214 - INFO - [test_dav_creation:390] -    -> Lançando produto: 9
2025-09-05 08:47:13,228 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:47:13,231 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 08:47:13,461 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:47:13,788 - INFO - [test_dav_creation:435] - Estoque disponível: 29. Quantidade sorteada: 20
2025-09-05 08:47:14,052 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:47:14,056 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:47:14,580 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:47:17,672 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:47:18,407 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 08:49:38,196 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-05 08:49:39,488 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 08:49:39,488 - INFO - [test_dav_creation:390] -    -> Lançando produto: 16
2025-09-05 08:49:39,538 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:49:39,541 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 08:49:39,770 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:49:40,181 - INFO - [test_dav_creation:435] - Estoque disponível: 145. Quantidade sorteada: 16
2025-09-05 08:49:40,694 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:49:40,698 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:49:41,220 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:49:44,372 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:49:45,103 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 08:49:57,203 - ERROR - [test_dav_creation:494] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 475, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 08:49:59,364 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 08:49:59,364 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 08:49:59,365 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 08:49:59,368 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 08:49:59,369 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 08:50:01,807 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 08:50:01,808 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-05 08:50:01,812 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 08:50:05,501 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 08:50:05,502 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 08:50:07,481 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-05 08:50:07,490 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:50:07,495 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 08:50:09,513 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 08:50:09,514 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 08:50:10,616 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 08:50:10,617 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 08:50:11,754 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 08:50:11,755 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 08:50:28,792 - INFO - [test_dav_creation:98] - Usuário selecionou 5 itens: ['8', '9', '11', '16', '19']
2025-09-05 08:50:28,795 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 08:50:28,800 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 08:50:28,800 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-05 08:50:31,801 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 08:50:31,806 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 08:50:32,018 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 08:50:32,032 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 08:50:32,032 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 08:50:32,642 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 08:50:33,749 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:50:33,750 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 08:50:34,003 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-05 08:50:34,003 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 08:50:34,004 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:50:34,007 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 08:50:34,021 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 08:50:34,272 - INFO - [test_dav_creation:290] -    -> Cliente '69365' inserido.
2025-09-05 08:50:35,297 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 08:50:35,301 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 08:50:35,318 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 08:50:36,410 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-05 08:50:36,410 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-05 08:50:36,410 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 08:50:36,410 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 08:50:36,689 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-05 08:50:37,781 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 08:50:37,781 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 08:50:37,876 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 08:50:37,876 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-05 08:50:37,892 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 08:50:38,147 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-05 08:50:38,147 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 08:50:38,206 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 08:50:38,707 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 08:50:38,708 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 08:50:38,713 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 08:50:38,713 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-05 08:50:38,713 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 08:50:38,713 - INFO - [test_dav_creation:390] -    -> Lançando produto: 8
2025-09-05 08:50:38,730 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:38,733 - INFO - [test_dav_creation:407] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 08:50:38,956 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:50:39,374 - INFO - [test_dav_creation:435] - Estoque disponível: 484. Quantidade sorteada: 4
2025-09-05 08:50:39,638 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:39,642 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:40,243 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:50:43,277 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:50:43,839 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 08:50:51,318 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-05 08:50:52,591 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 08:50:52,591 - INFO - [test_dav_creation:390] -    -> Lançando produto: 9
2025-09-05 08:50:52,606 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:52,609 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 08:50:52,841 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 08:50:53,164 - INFO - [test_dav_creation:435] - Estoque disponível: 29. Quantidade sorteada: 16
2025-09-05 08:50:53,424 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:53,428 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 08:50:53,951 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-05 08:50:57,001 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 08:50:57,735 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 09:47:48,613 - ERROR - [test_dav_creation:494] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 475, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 09:47:51,106 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 09:47:51,107 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:12:58,433 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:12:58,433 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:12:58,459 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:12:58,459 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:12:58,460 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:12:58,471 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:13:00,073 - INFO - [test_dav_creation:184] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:13:00,073 - INFO - [test_dav_creation:190] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:13:00,084 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:13:00,087 - INFO - [test_dav_creation:196] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:13:00,088 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:13:02,202 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:13:02,202 - INFO - [test_dav_creation:200] - Trabalhando com a filial: 4
2025-09-05 10:13:02,203 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:13:04,337 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:13:04,339 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:13:06,113 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 10:13:06,123 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:13:06,129 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:13:07,413 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:13:07,414 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:13:08,451 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:13:08,465 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:13:09,431 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:13:09,436 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:13:26,525 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['9', '11', '18', '21']
2025-09-05 10:13:26,528 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:13:26,533 - INFO - [test_dav_creation:255] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:13:26,533 - INFO - [test_dav_creation:256] - A automação da interface começará em 3 segundos...
2025-09-05 10:13:29,534 - INFO - [test_dav_creation:262] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:13:29,542 - INFO - [test_dav_creation:267] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:13:29,753 - INFO - [test_dav_creation:272] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:13:29,770 - INFO - [test_dav_creation:276] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:13:29,770 - INFO - [test_dav_creation:279] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:13:30,335 - INFO - [test_dav_creation:283] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:13:31,442 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:13:31,442 - INFO - [test_dav_creation:290] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:13:31,802 - INFO - [test_dav_creation:293] -    -> Natureza 'VIN' inserida.
2025-09-05 10:13:31,802 - INFO - [test_dav_creation:296] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:13:31,811 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:13:31,819 - INFO - [test_dav_creation:302] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:13:31,834 - INFO - [test_dav_creation:306] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:13:32,052 - INFO - [test_dav_creation:309] -    -> Cliente '65820' inserido.
2025-09-05 10:13:33,071 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:13:34,164 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:13:35,256 - INFO - [test_dav_creation:331] - Tela de endereços não foi encontrada script continua
2025-09-05 10:13:35,264 - INFO - [test_dav_creation:334] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:13:35,264 - INFO - [test_dav_creation:335] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:13:35,264 - INFO - [test_dav_creation:343] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:13:35,396 - INFO - [test_dav_creation:347] -    -> Vendedor '504' inserido.
2025-09-05 10:13:36,488 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:13:36,488 - INFO - [test_dav_creation:369] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:13:36,587 - INFO - [test_dav_creation:373] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:13:36,587 - INFO - [test_dav_creation:376] - Passo 13: Pressionando ENTER.
2025-09-05 10:13:36,603 - INFO - [test_dav_creation:380] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:13:36,803 - INFO - [test_dav_creation:383] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:13:36,804 - INFO - [test_dav_creation:386] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:13:36,883 - INFO - [test_dav_creation:388] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:13:37,384 - INFO - [test_dav_creation:391] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:13:37,385 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:13:37,391 - INFO - [test_dav_creation:402] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:13:37,391 - INFO - [test_dav_creation:405] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:13:37,391 - INFO - [test_dav_creation:406] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:13:37,391 - INFO - [test_dav_creation:409] -    -> Lançando produto: 9
2025-09-05 10:13:37,406 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:13:37,409 - INFO - [test_dav_creation:426] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:13:37,639 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:13:37,967 - INFO - [test_dav_creation:454] - Estoque disponível: 29. Quantidade sorteada: 4
2025-09-05 10:13:38,233 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:13:38,238 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:13:38,761 - INFO - [test_dav_creation:477] - Verificando se a janela de autorização apareceu...
2025-09-05 10:13:38,761 - INFO - [test_dav_creation:146] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 10:13:48,242 - INFO - [test_dav_creation:174] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:13:48,801 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:14:01,225 - INFO - [test_dav_creation:495] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:14:02,424 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:14:02,425 - INFO - [test_dav_creation:409] -    -> Lançando produto: 11
2025-09-05 10:14:02,471 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:02,475 - INFO - [test_dav_creation:426] - Produto tem 3 unidade(s) mapeada(s).
2025-09-05 10:14:02,714 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:14:03,012 - INFO - [test_dav_creation:454] - Estoque disponível: 23. Quantidade sorteada: 1
2025-09-05 10:14:03,270 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:03,283 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:03,807 - INFO - [test_dav_creation:477] - Verificando se a janela de autorização apareceu...
2025-09-05 10:14:03,807 - INFO - [test_dav_creation:146] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 10:14:13,125 - INFO - [test_dav_creation:174] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:14:13,686 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:14:22,283 - INFO - [test_dav_creation:495] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:14:23,491 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:14:23,491 - INFO - [test_dav_creation:409] -    -> Lançando produto: 18
2025-09-05 10:14:23,515 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:23,518 - INFO - [test_dav_creation:426] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:14:23,832 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:14:24,179 - INFO - [test_dav_creation:454] - Estoque disponível: 20. Quantidade sorteada: 6
2025-09-05 10:14:24,521 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:24,529 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:14:25,055 - INFO - [test_dav_creation:477] - Verificando se a janela de autorização apareceu...
2025-09-05 10:14:25,055 - INFO - [test_dav_creation:146] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 10:14:34,983 - INFO - [test_dav_creation:174] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:14:35,543 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:15:00,238 - ERROR - [test_dav_creation:513] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 494, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 10:15:10,913 - INFO - [test_dav_creation:184] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:15:10,913 - INFO - [test_dav_creation:190] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:15:10,914 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:15:10,918 - INFO - [test_dav_creation:196] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:15:10,921 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:15:12,816 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:15:12,817 - INFO - [test_dav_creation:200] - Trabalhando com a filial: 4
2025-09-05 10:15:12,818 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:15:15,126 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:15:15,127 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:15:17,568 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-05 10:15:17,569 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:15:17,572 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:15:19,845 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:15:19,846 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:15:20,816 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:15:20,817 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:15:21,519 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:15:21,521 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:15:30,409 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['9', '10']
2025-09-05 10:15:30,411 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:15:30,416 - INFO - [test_dav_creation:255] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:15:30,417 - INFO - [test_dav_creation:256] - A automação da interface começará em 3 segundos...
2025-09-05 10:15:33,417 - INFO - [test_dav_creation:262] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:15:33,423 - INFO - [test_dav_creation:267] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:15:33,689 - INFO - [test_dav_creation:272] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:15:33,702 - INFO - [test_dav_creation:276] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:15:33,702 - INFO - [test_dav_creation:279] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:15:34,463 - INFO - [test_dav_creation:283] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:15:35,569 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:15:35,569 - INFO - [test_dav_creation:290] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:15:35,843 - INFO - [test_dav_creation:293] -    -> Natureza 'VIN' inserida.
2025-09-05 10:15:35,844 - INFO - [test_dav_creation:296] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:15:35,845 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:15:35,847 - INFO - [test_dav_creation:302] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:15:35,861 - INFO - [test_dav_creation:306] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:15:36,096 - INFO - [test_dav_creation:309] -    -> Cliente '69365' inserido.
2025-09-05 10:15:37,203 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:15:37,208 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 10:15:37,228 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:15:38,322 - INFO - [test_dav_creation:331] - Tela de endereços não foi encontrada script continua
2025-09-05 10:15:38,350 - INFO - [test_dav_creation:334] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:15:38,350 - INFO - [test_dav_creation:335] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:15:38,350 - INFO - [test_dav_creation:343] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:15:38,630 - INFO - [test_dav_creation:347] -    -> Vendedor '504' inserido.
2025-09-05 10:15:39,722 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:15:39,725 - INFO - [test_dav_creation:369] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:15:39,928 - INFO - [test_dav_creation:373] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:15:39,928 - INFO - [test_dav_creation:376] - Passo 13: Pressionando ENTER.
2025-09-05 10:15:39,943 - INFO - [test_dav_creation:380] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:15:40,140 - INFO - [test_dav_creation:383] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:15:40,140 - INFO - [test_dav_creation:386] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:15:40,198 - INFO - [test_dav_creation:388] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:15:40,699 - INFO - [test_dav_creation:391] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:15:40,700 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:15:40,703 - INFO - [test_dav_creation:402] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:15:40,703 - INFO - [test_dav_creation:405] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:15:40,703 - INFO - [test_dav_creation:406] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:15:40,703 - INFO - [test_dav_creation:409] -    -> Lançando produto: 9
2025-09-05 10:15:40,719 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:15:40,722 - INFO - [test_dav_creation:426] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:15:40,953 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:15:41,271 - INFO - [test_dav_creation:454] - Estoque disponível: 29. Quantidade sorteada: 12
2025-09-05 10:15:41,613 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:15:41,617 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:15:42,138 - INFO - [test_dav_creation:477] - Verificando se a janela de autorização apareceu...
2025-09-05 10:15:42,138 - INFO - [test_dav_creation:146] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 10:15:52,763 - INFO - [test_dav_creation:174] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:15:53,494 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:35:17,703 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:35:17,703 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:35:17,728 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:35:17,728 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:35:17,729 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:35:17,756 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:35:20,752 - INFO - [test_dav_creation:180] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:35:20,752 - INFO - [test_dav_creation:186] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:35:20,753 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:35:20,757 - INFO - [test_dav_creation:192] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:35:20,760 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:35:23,425 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:35:23,426 - INFO - [test_dav_creation:196] - Trabalhando com a filial: 4
2025-09-05 10:35:23,427 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:35:30,623 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:35:30,624 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:35:33,715 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-05 10:35:33,716 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:35:33,720 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:35:35,501 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:35:35,502 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:35:36,519 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:35:36,525 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:35:37,424 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:35:37,425 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:35:46,117 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 10:35:46,120 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:35:46,128 - INFO - [test_dav_creation:251] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:35:46,129 - INFO - [test_dav_creation:252] - A automação da interface começará em 3 segundos...
2025-09-05 10:35:49,129 - INFO - [test_dav_creation:258] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:35:49,136 - INFO - [test_dav_creation:263] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:35:49,175 - INFO - [test_dav_creation:268] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:35:49,191 - INFO - [test_dav_creation:272] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:35:49,191 - INFO - [test_dav_creation:275] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:35:49,754 - INFO - [test_dav_creation:279] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:35:50,770 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:35:50,770 - INFO - [test_dav_creation:286] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:35:51,032 - INFO - [test_dav_creation:289] -    -> Natureza 'VIN' inserida.
2025-09-05 10:35:51,032 - INFO - [test_dav_creation:292] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:35:51,033 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:35:51,037 - INFO - [test_dav_creation:298] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:35:51,051 - INFO - [test_dav_creation:302] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:35:51,283 - INFO - [test_dav_creation:305] -    -> Cliente '69365' inserido.
2025-09-05 10:35:52,388 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:35:52,393 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 10:35:52,410 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:35:53,539 - INFO - [test_dav_creation:327] - Tela de endereços não foi encontrada script continua
2025-09-05 10:35:53,540 - INFO - [test_dav_creation:330] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:35:53,540 - INFO - [test_dav_creation:331] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:35:53,540 - INFO - [test_dav_creation:339] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:35:53,820 - INFO - [test_dav_creation:343] -    -> Vendedor '504' inserido.
2025-09-05 10:35:54,911 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:35:54,912 - INFO - [test_dav_creation:365] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:35:55,135 - INFO - [test_dav_creation:369] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:35:55,135 - INFO - [test_dav_creation:372] - Passo 13: Pressionando ENTER.
2025-09-05 10:35:55,150 - INFO - [test_dav_creation:376] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:35:55,357 - INFO - [test_dav_creation:379] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:35:55,357 - INFO - [test_dav_creation:382] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:35:55,417 - INFO - [test_dav_creation:384] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:35:55,918 - INFO - [test_dav_creation:387] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:35:55,920 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:35:55,925 - INFO - [test_dav_creation:398] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:35:55,925 - INFO - [test_dav_creation:401] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:35:55,925 - INFO - [test_dav_creation:402] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:35:55,925 - INFO - [test_dav_creation:405] -    -> Lançando produto: 9
2025-09-05 10:35:55,947 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:35:55,951 - INFO - [test_dav_creation:422] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:35:56,181 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:35:56,480 - INFO - [test_dav_creation:450] - Estoque disponível: 29. Quantidade sorteada: 8
2025-09-05 10:35:56,755 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:35:56,760 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:35:57,282 - INFO - [test_dav_creation:473] - Verificando se a janela de autorização apareceu...
2025-09-05 10:35:57,282 - INFO - [test_dav_creation:143] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 10:36:01,726 - INFO - [test_dav_creation:170] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:36:02,286 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:36:11,664 - INFO - [test_dav_creation:491] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:36:12,955 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:36:12,956 - INFO - [test_dav_creation:505] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 10:36:12,956 - INFO - [test_dav_creation:506] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 10:41:32,840 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 10:41:32,841 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:41:41,263 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:41:41,263 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:41:41,282 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:41:41,282 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:41:41,283 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:41:41,290 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:41:42,800 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:41:42,800 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:41:42,808 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:41:42,811 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:41:42,812 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:41:48,008 - ERROR - [test_dav_creation:49] - Nenhum item foi selecionado ou a janela foi fechada.
2025-09-05 10:41:48,009 - ERROR - [test_dav_creation:514] - Ocorreu um erro durante o teste de criação de DAV: Seleção de Filial foi cancelada.
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 192, in run
    if not selected_filial_code: raise ValueError("Seleção de Filial foi cancelada.")
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Seleção de Filial foi cancelada.
2025-09-05 10:41:51,808 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 10:41:51,808 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:42:44,152 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:42:44,152 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:42:44,171 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:42:44,171 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:42:44,172 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:42:44,200 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:42:45,936 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:42:45,936 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:42:45,940 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:42:45,943 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:42:45,944 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:42:47,630 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:42:47,630 - INFO - [test_dav_creation:193] - Trabalhando com a filial: 4
2025-09-05 10:42:47,631 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:42:49,692 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:42:49,693 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:42:51,415 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-05 10:42:51,471 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:42:51,478 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:42:53,421 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:42:53,422 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:42:54,605 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:42:54,606 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:42:55,733 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:42:55,735 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:43:09,380 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['2', '9']
2025-09-05 10:43:09,382 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:43:09,388 - INFO - [test_dav_creation:248] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:43:09,388 - INFO - [test_dav_creation:249] - A automação da interface começará em 3 segundos...
2025-09-05 10:43:12,389 - INFO - [test_dav_creation:256] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:43:12,395 - INFO - [test_dav_creation:261] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:43:12,571 - INFO - [test_dav_creation:265] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 10:43:14,596 - INFO - [test_dav_creation:268] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 10:43:14,631 - INFO - [test_dav_creation:273] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:43:14,647 - INFO - [test_dav_creation:277] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:43:14,647 - INFO - [test_dav_creation:280] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:43:15,342 - INFO - [test_dav_creation:284] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:43:16,360 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:43:16,360 - INFO - [test_dav_creation:291] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:43:16,665 - INFO - [test_dav_creation:294] -    -> Natureza 'VIN' inserida.
2025-09-05 10:43:16,665 - INFO - [test_dav_creation:297] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:43:16,667 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:43:16,671 - INFO - [test_dav_creation:303] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:43:16,686 - INFO - [test_dav_creation:307] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:43:16,914 - INFO - [test_dav_creation:310] -    -> Cliente '69365' inserido.
2025-09-05 10:43:18,022 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:43:18,027 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 10:43:18,042 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:43:19,133 - INFO - [test_dav_creation:332] - Tela de endereços não foi encontrada script continua
2025-09-05 10:43:19,133 - INFO - [test_dav_creation:335] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:43:19,133 - INFO - [test_dav_creation:336] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:43:19,133 - INFO - [test_dav_creation:344] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:43:19,413 - INFO - [test_dav_creation:348] -    -> Vendedor '504' inserido.
2025-09-05 10:43:20,506 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:43:20,506 - INFO - [test_dav_creation:370] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:43:20,606 - INFO - [test_dav_creation:374] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:43:20,606 - INFO - [test_dav_creation:377] - Passo 13: Pressionando ENTER.
2025-09-05 10:43:20,622 - INFO - [test_dav_creation:381] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:43:20,866 - INFO - [test_dav_creation:384] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:43:20,867 - INFO - [test_dav_creation:387] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:43:20,925 - INFO - [test_dav_creation:389] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:43:21,426 - INFO - [test_dav_creation:392] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:43:21,427 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:43:21,430 - INFO - [test_dav_creation:403] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:43:21,430 - INFO - [test_dav_creation:406] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:43:21,431 - INFO - [test_dav_creation:407] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:43:21,431 - INFO - [test_dav_creation:410] -    -> Lançando produto: 2
2025-09-05 10:43:21,446 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:43:21,449 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:43:21,680 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:43:21,988 - INFO - [test_dav_creation:455] - Estoque disponível: 545. Quantidade sorteada: 16
2025-09-05 10:43:22,251 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:43:22,256 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:43:22,778 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:43:28,529 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:43:29,100 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:43:59,200 - INFO - [test_dav_creation:496] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:44:00,475 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:44:00,475 - INFO - [test_dav_creation:410] -    -> Lançando produto: 9
2025-09-05 10:44:00,513 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:44:00,516 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:44:00,796 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:44:01,103 - INFO - [test_dav_creation:455] - Estoque disponível: 29. Quantidade sorteada: 11
2025-09-05 10:44:01,593 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:44:01,597 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:44:02,119 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:44:07,828 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:44:08,559 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:45:48,288 - INFO - [test_dav_creation:496] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:45:49,610 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:45:49,610 - INFO - [test_dav_creation:510] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 10:45:49,610 - INFO - [test_dav_creation:511] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 10:46:28,832 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 10:46:28,832 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:46:30,830 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:46:30,830 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:46:30,847 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:46:30,848 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:46:30,848 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:46:30,858 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:46:35,281 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:46:35,281 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:46:35,282 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:46:35,286 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:46:35,287 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:46:37,199 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:46:37,200 - INFO - [test_dav_creation:193] - Trabalhando com a filial: 4
2025-09-05 10:46:37,200 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:46:39,095 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:46:39,096 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:46:40,610 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 10:46:40,615 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:46:40,628 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:46:43,277 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:46:43,279 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:46:44,182 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:46:44,188 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:46:44,887 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:46:44,895 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:46:51,239 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['2', '9']
2025-09-05 10:46:51,242 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:46:51,251 - INFO - [test_dav_creation:248] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:46:51,251 - INFO - [test_dav_creation:249] - A automação da interface começará em 3 segundos...
2025-09-05 10:46:54,252 - INFO - [test_dav_creation:256] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:46:54,257 - INFO - [test_dav_creation:261] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:46:54,433 - INFO - [test_dav_creation:265] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 10:46:56,622 - INFO - [test_dav_creation:268] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 10:46:56,658 - INFO - [test_dav_creation:273] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:46:56,673 - INFO - [test_dav_creation:277] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:46:56,673 - INFO - [test_dav_creation:280] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:46:57,766 - INFO - [test_dav_creation:284] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:46:58,876 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:46:58,876 - INFO - [test_dav_creation:291] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:46:59,248 - INFO - [test_dav_creation:294] -    -> Natureza 'VIN' inserida.
2025-09-05 10:46:59,249 - INFO - [test_dav_creation:297] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:46:59,250 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:46:59,254 - INFO - [test_dav_creation:303] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:46:59,269 - INFO - [test_dav_creation:307] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:46:59,609 - INFO - [test_dav_creation:310] -    -> Cliente '65820' inserido.
2025-09-05 10:47:00,727 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:47:01,818 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:47:02,910 - INFO - [test_dav_creation:332] - Tela de endereços não foi encontrada script continua
2025-09-05 10:47:02,910 - INFO - [test_dav_creation:335] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:47:02,910 - INFO - [test_dav_creation:336] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:47:02,910 - INFO - [test_dav_creation:344] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:47:03,071 - INFO - [test_dav_creation:348] -    -> Vendedor '504' inserido.
2025-09-05 10:47:04,162 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:47:04,163 - INFO - [test_dav_creation:370] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:47:04,259 - INFO - [test_dav_creation:374] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:47:04,260 - INFO - [test_dav_creation:377] - Passo 13: Pressionando ENTER.
2025-09-05 10:47:04,276 - INFO - [test_dav_creation:381] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:47:04,603 - INFO - [test_dav_creation:384] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:47:04,603 - INFO - [test_dav_creation:387] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:47:04,661 - INFO - [test_dav_creation:389] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:47:05,162 - INFO - [test_dav_creation:392] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:47:05,163 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:47:05,169 - INFO - [test_dav_creation:403] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:47:05,170 - INFO - [test_dav_creation:406] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:47:05,170 - INFO - [test_dav_creation:407] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:47:05,170 - INFO - [test_dav_creation:410] -    -> Lançando produto: 2
2025-09-05 10:47:05,185 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:47:05,188 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:47:05,418 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:47:05,918 - INFO - [test_dav_creation:455] - Estoque disponível: 545. Quantidade sorteada: 19
2025-09-05 10:47:06,185 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:47:06,189 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:47:06,710 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:47:11,965 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:47:12,697 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:47:27,907 - ERROR - [test_dav_creation:514] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 495, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 10:47:29,944 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:47:29,944 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:47:29,946 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:47:29,949 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:47:29,952 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:47:31,538 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:47:31,581 - INFO - [test_dav_creation:193] - Trabalhando com a filial: 4
2025-09-05 10:47:31,583 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:47:33,378 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:47:33,379 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:47:34,769 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 10:47:34,775 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:47:34,780 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:47:36,024 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:47:36,025 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:47:36,988 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:47:36,991 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:47:37,944 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:47:37,945 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:47:46,245 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['2', '9']
2025-09-05 10:47:46,263 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:47:46,425 - INFO - [test_dav_creation:248] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:47:46,426 - INFO - [test_dav_creation:249] - A automação da interface começará em 3 segundos...
2025-09-05 10:47:49,426 - INFO - [test_dav_creation:256] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:47:49,432 - INFO - [test_dav_creation:261] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:47:49,608 - INFO - [test_dav_creation:265] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 10:47:51,776 - INFO - [test_dav_creation:268] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 10:47:51,812 - INFO - [test_dav_creation:273] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:47:51,827 - INFO - [test_dav_creation:277] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:47:51,827 - INFO - [test_dav_creation:280] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:47:52,486 - INFO - [test_dav_creation:284] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:47:53,593 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:47:53,594 - INFO - [test_dav_creation:291] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:47:53,847 - INFO - [test_dav_creation:294] -    -> Natureza 'VIN' inserida.
2025-09-05 10:47:53,848 - INFO - [test_dav_creation:297] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:47:53,849 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:47:53,852 - INFO - [test_dav_creation:303] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:47:53,867 - INFO - [test_dav_creation:307] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:47:54,107 - INFO - [test_dav_creation:310] -    -> Cliente '65820' inserido.
2025-09-05 10:47:55,216 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 10:47:56,308 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:47:57,382 - INFO - [test_dav_creation:332] - Tela de endereços não foi encontrada script continua
2025-09-05 10:47:57,382 - INFO - [test_dav_creation:335] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:47:57,382 - INFO - [test_dav_creation:336] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:47:57,382 - INFO - [test_dav_creation:344] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:47:57,490 - INFO - [test_dav_creation:348] -    -> Vendedor '504' inserido.
2025-09-05 10:47:58,581 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:47:58,581 - INFO - [test_dav_creation:370] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:47:58,680 - INFO - [test_dav_creation:374] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:47:58,680 - INFO - [test_dav_creation:377] - Passo 13: Pressionando ENTER.
2025-09-05 10:47:58,694 - INFO - [test_dav_creation:381] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:47:58,958 - INFO - [test_dav_creation:384] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:47:58,958 - INFO - [test_dav_creation:387] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:47:59,017 - INFO - [test_dav_creation:389] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:47:59,518 - INFO - [test_dav_creation:392] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:47:59,519 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:47:59,523 - INFO - [test_dav_creation:403] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:47:59,523 - INFO - [test_dav_creation:406] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:47:59,523 - INFO - [test_dav_creation:407] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:47:59,523 - INFO - [test_dav_creation:410] -    -> Lançando produto: 2
2025-09-05 10:47:59,562 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:47:59,565 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:47:59,797 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:48:00,270 - INFO - [test_dav_creation:455] - Estoque disponível: 545. Quantidade sorteada: 16
2025-09-05 10:48:00,532 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:48:00,537 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:48:01,059 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:48:06,264 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:48:06,996 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:48:19,523 - ERROR - [test_dav_creation:514] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 495, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 10:48:24,080 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:48:24,080 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:48:24,081 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:48:24,084 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:48:24,085 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:48:26,575 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:48:26,575 - INFO - [test_dav_creation:193] - Trabalhando com a filial: 4
2025-09-05 10:48:26,577 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:48:29,482 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:48:29,484 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:48:32,389 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 10:48:32,402 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:48:32,438 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:48:35,541 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:48:35,543 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:48:37,134 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:48:37,136 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:48:38,153 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:48:38,155 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:48:43,111 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 10:48:43,113 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:48:43,118 - INFO - [test_dav_creation:248] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:48:43,118 - INFO - [test_dav_creation:249] - A automação da interface começará em 3 segundos...
2025-09-05 10:48:46,119 - INFO - [test_dav_creation:256] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:48:46,127 - INFO - [test_dav_creation:261] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:48:46,302 - INFO - [test_dav_creation:265] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 10:48:48,394 - INFO - [test_dav_creation:268] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 10:48:48,429 - INFO - [test_dav_creation:273] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:48:48,443 - INFO - [test_dav_creation:277] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:48:48,443 - INFO - [test_dav_creation:280] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:48:49,155 - INFO - [test_dav_creation:284] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:48:50,262 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:48:50,262 - INFO - [test_dav_creation:291] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:48:54,391 - INFO - [test_dav_creation:294] -    -> Natureza 'VIN' inserida.
2025-09-05 10:48:54,391 - INFO - [test_dav_creation:297] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:48:54,393 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:48:54,396 - INFO - [test_dav_creation:303] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:48:54,411 - INFO - [test_dav_creation:307] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:48:54,628 - INFO - [test_dav_creation:310] -    -> Cliente '379' inserido.
2025-09-05 10:48:54,830 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 10:48:54,846 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:48:54,910 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 10:48:54,926 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:48:55,969 - INFO - [test_dav_creation:332] - Tela de endereços não foi encontrada script continua
2025-09-05 10:48:55,970 - INFO - [test_dav_creation:335] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:48:55,970 - INFO - [test_dav_creation:336] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:48:55,970 - INFO - [test_dav_creation:344] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:48:56,363 - INFO - [test_dav_creation:348] -    -> Vendedor '504' inserido.
2025-09-05 10:48:57,455 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:48:57,456 - INFO - [test_dav_creation:370] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:48:57,553 - INFO - [test_dav_creation:374] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:48:57,553 - INFO - [test_dav_creation:377] - Passo 13: Pressionando ENTER.
2025-09-05 10:48:57,568 - INFO - [test_dav_creation:381] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:48:57,845 - INFO - [test_dav_creation:384] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:48:57,845 - INFO - [test_dav_creation:387] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:48:57,903 - INFO - [test_dav_creation:389] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:48:58,403 - INFO - [test_dav_creation:392] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:48:58,406 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:48:58,535 - INFO - [test_dav_creation:403] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:48:58,535 - INFO - [test_dav_creation:406] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:48:58,535 - INFO - [test_dav_creation:407] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:48:58,536 - INFO - [test_dav_creation:410] -    -> Lançando produto: 9
2025-09-05 10:48:58,621 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:48:58,624 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:48:58,855 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:48:59,314 - INFO - [test_dav_creation:455] - Estoque disponível: 29. Quantidade sorteada: 10
2025-09-05 10:48:59,668 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:48:59,784 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:49:00,342 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:49:05,992 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:49:06,553 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 10:49:15,079 - INFO - [test_dav_creation:496] - Pressionando ENTER 2x para gravar o item.
2025-09-05 10:49:16,367 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 10:49:16,368 - INFO - [test_dav_creation:510] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 10:49:16,368 - INFO - [test_dav_creation:511] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 10:51:42,311 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 10:51:42,312 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:51:44,644 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:51:44,644 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:51:44,662 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:51:44,662 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:51:44,663 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:51:44,673 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:51:46,760 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 10:51:46,760 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 10:51:59,687 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 10:51:59,688 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 10:51:59,719 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 10:51:59,719 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 10:51:59,720 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 10:51:59,732 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 10:52:04,536 - INFO - [test_dav_creation:177] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 10:52:04,536 - INFO - [test_dav_creation:183] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 10:52:04,537 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 10:52:04,540 - INFO - [test_dav_creation:189] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 10:52:04,541 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 10:52:06,146 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 10:52:06,146 - INFO - [test_dav_creation:193] - Trabalhando com a filial: 4
2025-09-05 10:52:06,147 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 10:52:09,206 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 10:52:09,208 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 10:52:10,879 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 10:52:10,881 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:52:10,887 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 10:52:12,610 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 10:52:12,614 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 10:52:13,631 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 10:52:13,633 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 10:52:14,322 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 10:52:14,323 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 10:52:20,609 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 10:52:20,611 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 10:52:20,618 - INFO - [test_dav_creation:248] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 10:52:20,618 - INFO - [test_dav_creation:249] - A automação da interface começará em 3 segundos...
2025-09-05 10:52:23,619 - INFO - [test_dav_creation:256] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 10:52:23,625 - INFO - [test_dav_creation:261] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 10:52:23,800 - INFO - [test_dav_creation:265] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 10:52:25,713 - INFO - [test_dav_creation:268] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 10:52:25,750 - INFO - [test_dav_creation:273] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 10:52:25,764 - INFO - [test_dav_creation:277] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 10:52:25,764 - INFO - [test_dav_creation:280] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 10:52:26,329 - INFO - [test_dav_creation:284] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 10:52:27,441 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:52:27,442 - INFO - [test_dav_creation:291] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 10:52:27,695 - INFO - [test_dav_creation:294] -    -> Natureza 'VIN' inserida.
2025-09-05 10:52:27,695 - INFO - [test_dav_creation:297] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 10:52:27,696 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:52:27,700 - INFO - [test_dav_creation:303] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 10:52:27,841 - INFO - [test_dav_creation:307] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 10:52:28,052 - INFO - [test_dav_creation:310] -    -> Cliente '379' inserido.
2025-09-05 10:52:28,103 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 10:52:28,119 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:52:28,185 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 10:52:28,202 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 10:52:29,226 - INFO - [test_dav_creation:332] - Tela de endereços não foi encontrada script continua
2025-09-05 10:52:29,226 - INFO - [test_dav_creation:335] - Passo 9: Verificando configuração do vendedor...
2025-09-05 10:52:29,226 - INFO - [test_dav_creation:336] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 10:52:29,227 - INFO - [test_dav_creation:344] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 10:52:29,505 - INFO - [test_dav_creation:348] -    -> Vendedor '504' inserido.
2025-09-05 10:52:30,597 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 10:52:30,598 - INFO - [test_dav_creation:370] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 10:52:30,696 - INFO - [test_dav_creation:374] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 10:52:30,696 - INFO - [test_dav_creation:377] - Passo 13: Pressionando ENTER.
2025-09-05 10:52:30,713 - INFO - [test_dav_creation:381] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 10:52:30,987 - INFO - [test_dav_creation:384] -    -> Condição de pagamento '113' inserida.
2025-09-05 10:52:30,987 - INFO - [test_dav_creation:387] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 10:52:31,045 - INFO - [test_dav_creation:389] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 10:52:31,546 - INFO - [test_dav_creation:392] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 10:52:31,547 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 10:52:31,553 - INFO - [test_dav_creation:403] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 10:52:31,553 - INFO - [test_dav_creation:406] - Passo 17: Iniciando lançamento de itens...
2025-09-05 10:52:31,553 - INFO - [test_dav_creation:407] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 10:52:31,554 - INFO - [test_dav_creation:410] -    -> Lançando produto: 9
2025-09-05 10:52:31,569 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:52:31,572 - INFO - [test_dav_creation:427] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 10:52:31,802 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 10:52:32,114 - INFO - [test_dav_creation:455] - Estoque disponível: 29. Quantidade sorteada: 20
2025-09-05 10:52:32,380 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:52:32,390 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 10:52:32,912 - INFO - [test_dav_creation:478] - Verificando se a janela de autorização apareceu...
2025-09-05 10:52:38,907 - INFO - [test_dav_creation:166] - Janela de autorização não apareceu. Prosseguindo...
2025-09-05 10:52:39,640 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:04:24,456 - ERROR - [test_dav_creation:514] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 495, in run
    pa2_infdescped = db_handler.check_field_value(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 11:04:27,359 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 11:04:27,359 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 11:04:31,318 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 11:04:31,318 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 11:04:31,337 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 11:04:31,337 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 11:04:31,338 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 11:04:31,346 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 11:04:35,287 - INFO - [test_dav_creation:204] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:04:35,287 - INFO - [test_dav_creation:210] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:04:35,289 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:04:35,300 - INFO - [test_dav_creation:216] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:04:35,301 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:04:37,701 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:04:37,701 - INFO - [test_dav_creation:220] - Trabalhando com a filial: 4
2025-09-05 11:04:37,702 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:04:39,988 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:04:39,991 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:04:41,690 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:04:41,692 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:04:41,696 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:04:43,422 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:04:43,423 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:04:44,710 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:04:44,711 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:04:45,867 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:04:45,869 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:04:57,999 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['9', '10']
2025-09-05 11:04:58,002 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:04:58,014 - INFO - [test_dav_creation:275] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:04:58,015 - INFO - [test_dav_creation:276] - A automação da interface começará em 3 segundos...
2025-09-05 11:05:01,015 - INFO - [test_dav_creation:283] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:05:01,029 - INFO - [test_dav_creation:288] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:05:01,205 - INFO - [test_dav_creation:292] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 11:05:03,179 - INFO - [test_dav_creation:295] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 11:05:03,216 - INFO - [test_dav_creation:300] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:05:03,231 - INFO - [test_dav_creation:304] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:05:03,231 - INFO - [test_dav_creation:307] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:05:03,794 - INFO - [test_dav_creation:311] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:05:04,901 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:05:04,902 - INFO - [test_dav_creation:318] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:05:05,160 - INFO - [test_dav_creation:321] -    -> Natureza 'VIN' inserida.
2025-09-05 11:05:05,160 - INFO - [test_dav_creation:324] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:05:05,161 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:05:05,165 - INFO - [test_dav_creation:330] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:05:05,181 - INFO - [test_dav_creation:334] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:05:05,385 - INFO - [test_dav_creation:337] -    -> Cliente '379' inserido.
2025-09-05 11:05:05,441 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:05:05,457 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:05:05,521 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:05:05,547 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:05:06,660 - INFO - [test_dav_creation:359] - Tela de endereços não foi encontrada script continua
2025-09-05 11:05:06,661 - INFO - [test_dav_creation:362] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:05:06,661 - INFO - [test_dav_creation:363] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:05:06,661 - INFO - [test_dav_creation:371] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:05:06,942 - INFO - [test_dav_creation:375] -    -> Vendedor '504' inserido.
2025-09-05 11:05:07,943 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:05:07,943 - INFO - [test_dav_creation:397] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:05:08,040 - INFO - [test_dav_creation:401] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:05:08,041 - INFO - [test_dav_creation:404] - Passo 13: Pressionando ENTER.
2025-09-05 11:05:08,055 - INFO - [test_dav_creation:408] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:05:08,310 - INFO - [test_dav_creation:411] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:05:08,311 - INFO - [test_dav_creation:414] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:05:08,369 - INFO - [test_dav_creation:416] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:05:08,870 - INFO - [test_dav_creation:419] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:05:08,871 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:05:08,875 - INFO - [test_dav_creation:430] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:05:08,875 - INFO - [test_dav_creation:433] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:05:08,875 - INFO - [test_dav_creation:434] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:05:08,876 - INFO - [test_dav_creation:437] -    -> Lançando produto: 9
2025-09-05 11:05:08,891 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:08,893 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:05:09,123 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:05:09,446 - INFO - [test_dav_creation:482] - Estoque disponível: 29. Quantidade sorteada: 5
2025-09-05 11:05:09,709 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:09,750 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:10,392 - INFO - [test_dav_creation:505] - Verificando se a janela de autorização apareceu...
2025-09-05 11:05:10,984 - INFO - [test_dav_creation:149] - Pré-verificação (win32): Janela de autorização não apareceu.
2025-09-05 11:05:11,579 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:05:17,078 - INFO - [test_dav_creation:526] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:05:18,377 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:05:18,377 - INFO - [test_dav_creation:437] -    -> Lançando produto: 10
2025-09-05 11:05:18,403 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:18,405 - INFO - [test_dav_creation:454] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 11:05:18,625 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:05:19,207 - INFO - [test_dav_creation:482] - Estoque disponível: 208. Quantidade sorteada: 8
2025-09-05 11:05:19,495 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:19,501 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:05:20,024 - INFO - [test_dav_creation:505] - Verificando se a janela de autorização apareceu...
2025-09-05 11:05:20,571 - INFO - [test_dav_creation:149] - Pré-verificação (win32): Janela de autorização não apareceu.
2025-09-05 11:05:21,254 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:05:27,671 - INFO - [test_dav_creation:526] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:05:28,962 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:05:28,963 - INFO - [test_dav_creation:540] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 11:05:28,963 - INFO - [test_dav_creation:541] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 11:05:46,639 - INFO - [test_dav_creation:204] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:05:46,639 - INFO - [test_dav_creation:210] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:05:46,640 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:05:46,643 - INFO - [test_dav_creation:216] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:05:46,644 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:05:48,695 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:05:48,695 - INFO - [test_dav_creation:220] - Trabalhando com a filial: 4
2025-09-05 11:05:48,697 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:05:50,720 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:05:50,721 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:05:52,450 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:05:52,451 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:05:52,455 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:05:54,580 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:05:54,584 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:05:56,285 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:05:56,286 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:05:56,987 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:05:56,989 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:06:04,773 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['9', '10', '11']
2025-09-05 11:06:05,082 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:06:05,088 - INFO - [test_dav_creation:275] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:06:05,089 - INFO - [test_dav_creation:276] - A automação da interface começará em 3 segundos...
2025-09-05 11:06:08,089 - INFO - [test_dav_creation:283] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:06:08,095 - INFO - [test_dav_creation:288] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:06:08,271 - INFO - [test_dav_creation:292] - Realizando conexão inicial com backend 'uia' para reutilização...
2025-09-05 11:06:10,325 - INFO - [test_dav_creation:295] - -> Conexão 'uia' pronta para ser usada nas autorizações.
2025-09-05 11:06:10,362 - INFO - [test_dav_creation:300] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:06:10,377 - INFO - [test_dav_creation:304] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:06:10,378 - INFO - [test_dav_creation:307] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:06:10,606 - INFO - [test_dav_creation:311] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:06:11,624 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:06:11,624 - INFO - [test_dav_creation:318] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:06:12,312 - INFO - [test_dav_creation:321] -    -> Natureza 'VIN' inserida.
2025-09-05 11:06:12,313 - INFO - [test_dav_creation:324] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:06:12,314 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:06:12,317 - INFO - [test_dav_creation:330] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:06:12,331 - INFO - [test_dav_creation:334] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:06:12,531 - INFO - [test_dav_creation:337] -    -> Cliente '379' inserido.
2025-09-05 11:06:12,582 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:06:12,598 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:06:12,787 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:06:12,866 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:06:13,868 - INFO - [test_dav_creation:359] - Tela de endereços não foi encontrada script continua
2025-09-05 11:06:13,869 - INFO - [test_dav_creation:362] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:06:13,869 - INFO - [test_dav_creation:363] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:06:13,869 - INFO - [test_dav_creation:371] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:06:14,149 - INFO - [test_dav_creation:375] -    -> Vendedor '504' inserido.
2025-09-05 11:06:15,241 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:06:15,241 - INFO - [test_dav_creation:397] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:06:15,464 - INFO - [test_dav_creation:401] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:06:15,465 - INFO - [test_dav_creation:404] - Passo 13: Pressionando ENTER.
2025-09-05 11:06:15,480 - INFO - [test_dav_creation:408] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:06:15,684 - INFO - [test_dav_creation:411] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:06:15,684 - INFO - [test_dav_creation:414] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:06:15,741 - INFO - [test_dav_creation:416] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:06:16,242 - INFO - [test_dav_creation:419] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:06:16,243 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:06:16,247 - INFO - [test_dav_creation:430] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:06:16,248 - INFO - [test_dav_creation:433] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:06:16,248 - INFO - [test_dav_creation:434] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:06:16,248 - INFO - [test_dav_creation:437] -    -> Lançando produto: 9
2025-09-05 11:06:16,270 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:06:16,273 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:06:16,507 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:06:16,949 - INFO - [test_dav_creation:482] - Estoque disponível: 29. Quantidade sorteada: 7
2025-09-05 11:06:17,223 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:06:17,229 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:06:17,749 - INFO - [test_dav_creation:505] - Verificando se a janela de autorização apareceu...
2025-09-05 11:06:18,949 - INFO - [test_dav_creation:149] - Pré-verificação (win32): Janela de autorização não apareceu.
2025-09-05 11:06:19,683 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:13:55,784 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 11:13:55,905 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 11:13:55,937 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 11:13:55,938 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 11:13:55,939 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 11:13:55,946 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 11:13:58,479 - INFO - [test_dav_creation:203] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:13:58,479 - INFO - [test_dav_creation:209] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:13:58,480 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:13:58,483 - INFO - [test_dav_creation:215] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:13:58,484 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:14:00,262 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:14:00,263 - INFO - [test_dav_creation:219] - Trabalhando com a filial: 4
2025-09-05 11:14:00,264 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:14:01,901 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:14:01,902 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:14:03,284 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:14:03,390 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:14:03,395 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:14:05,139 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:14:05,140 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:14:06,130 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:14:06,134 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:14:06,999 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:14:07,000 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:14:14,477 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['9', '10']
2025-09-05 11:14:14,525 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:14:14,530 - INFO - [test_dav_creation:274] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:14:14,530 - INFO - [test_dav_creation:275] - A automação da interface começará em 3 segundos...
2025-09-05 11:14:17,530 - INFO - [test_dav_creation:282] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:14:17,573 - INFO - [test_dav_creation:287] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:14:17,784 - INFO - [test_dav_creation:292] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:14:17,798 - INFO - [test_dav_creation:296] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:14:17,798 - INFO - [test_dav_creation:299] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:14:18,023 - INFO - [test_dav_creation:303] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:14:19,183 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:14:19,183 - INFO - [test_dav_creation:310] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:14:19,437 - INFO - [test_dav_creation:313] -    -> Natureza 'VIN' inserida.
2025-09-05 11:14:19,438 - INFO - [test_dav_creation:316] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:14:19,439 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:14:19,442 - INFO - [test_dav_creation:322] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:14:19,458 - INFO - [test_dav_creation:326] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:14:19,666 - INFO - [test_dav_creation:329] -    -> Cliente '379' inserido.
2025-09-05 11:14:19,717 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:14:19,733 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:14:19,832 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:14:19,848 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:14:20,892 - INFO - [test_dav_creation:351] - Tela de endereços não foi encontrada script continua
2025-09-05 11:14:20,892 - INFO - [test_dav_creation:354] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:14:20,892 - INFO - [test_dav_creation:355] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:14:20,892 - INFO - [test_dav_creation:363] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:14:21,171 - INFO - [test_dav_creation:367] -    -> Vendedor '504' inserido.
2025-09-05 11:14:22,173 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:14:22,173 - INFO - [test_dav_creation:389] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:14:22,271 - INFO - [test_dav_creation:393] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:14:22,271 - INFO - [test_dav_creation:396] - Passo 13: Pressionando ENTER.
2025-09-05 11:14:22,288 - INFO - [test_dav_creation:400] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:14:22,568 - INFO - [test_dav_creation:403] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:14:22,568 - INFO - [test_dav_creation:406] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:14:22,627 - INFO - [test_dav_creation:408] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:14:23,127 - INFO - [test_dav_creation:411] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:14:23,128 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:14:23,133 - INFO - [test_dav_creation:422] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:14:23,133 - INFO - [test_dav_creation:425] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:14:23,133 - INFO - [test_dav_creation:426] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:14:23,133 - INFO - [test_dav_creation:429] -    -> Lançando produto: 9
2025-09-05 11:14:23,148 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:14:23,151 - INFO - [test_dav_creation:446] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:14:23,383 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:14:23,691 - INFO - [test_dav_creation:474] - Estoque disponível: 29. Quantidade sorteada: 16
2025-09-05 11:14:23,959 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:14:23,966 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:14:24,612 - INFO - [test_dav_creation:497] - Verificando se a janela de autorização apareceu...
2025-09-05 11:14:25,203 - INFO - [test_dav_creation:148] - Pré-verificação (win32): Janela de autorização não apareceu.
2025-09-05 11:14:25,935 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:18:36,242 - ERROR - [test_dav_creation:536] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 517, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 11:18:43,559 - INFO - [test_dav_creation:203] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:18:43,559 - INFO - [test_dav_creation:209] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:18:43,560 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:18:43,563 - INFO - [test_dav_creation:215] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:18:43,563 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:18:45,772 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:18:45,772 - INFO - [test_dav_creation:219] - Trabalhando com a filial: 4
2025-09-05 11:18:45,773 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:18:47,778 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:18:47,779 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:18:49,406 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:18:49,407 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:18:49,412 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:18:51,163 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:18:51,164 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:18:52,263 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:18:52,264 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:18:53,307 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:18:53,309 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:18:59,475 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 11:18:59,477 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:18:59,482 - INFO - [test_dav_creation:274] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:18:59,482 - INFO - [test_dav_creation:275] - A automação da interface começará em 3 segundos...
2025-09-05 11:19:02,482 - INFO - [test_dav_creation:282] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:19:02,488 - INFO - [test_dav_creation:287] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:19:02,700 - INFO - [test_dav_creation:292] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:19:02,714 - INFO - [test_dav_creation:296] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:19:02,715 - INFO - [test_dav_creation:299] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:19:03,296 - INFO - [test_dav_creation:303] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:19:04,403 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:19:04,403 - INFO - [test_dav_creation:310] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:19:04,658 - INFO - [test_dav_creation:313] -    -> Natureza 'VIN' inserida.
2025-09-05 11:19:04,658 - INFO - [test_dav_creation:316] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:19:04,659 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:19:04,663 - INFO - [test_dav_creation:322] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:19:04,679 - INFO - [test_dav_creation:326] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:19:04,881 - INFO - [test_dav_creation:329] -    -> Cliente '379' inserido.
2025-09-05 11:19:04,934 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:19:04,950 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:19:05,012 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:19:05,028 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:19:06,137 - INFO - [test_dav_creation:351] - Tela de endereços não foi encontrada script continua
2025-09-05 11:19:06,138 - INFO - [test_dav_creation:354] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:19:06,138 - INFO - [test_dav_creation:355] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:19:06,138 - INFO - [test_dav_creation:363] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:19:06,419 - INFO - [test_dav_creation:367] -    -> Vendedor '504' inserido.
2025-09-05 11:19:07,511 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:19:07,512 - INFO - [test_dav_creation:389] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:19:07,610 - INFO - [test_dav_creation:393] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:19:07,610 - INFO - [test_dav_creation:396] - Passo 13: Pressionando ENTER.
2025-09-05 11:19:07,626 - INFO - [test_dav_creation:400] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:19:07,826 - INFO - [test_dav_creation:403] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:19:07,826 - INFO - [test_dav_creation:406] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:19:07,887 - INFO - [test_dav_creation:408] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:19:08,387 - INFO - [test_dav_creation:411] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:19:08,388 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:19:08,391 - INFO - [test_dav_creation:422] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:19:08,391 - INFO - [test_dav_creation:425] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:19:08,392 - INFO - [test_dav_creation:426] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:19:08,392 - INFO - [test_dav_creation:429] -    -> Lançando produto: 9
2025-09-05 11:19:08,409 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:19:08,412 - INFO - [test_dav_creation:446] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:19:08,643 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:19:08,936 - INFO - [test_dav_creation:474] - Estoque disponível: 29. Quantidade sorteada: 7
2025-09-05 11:19:09,193 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:19:09,197 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:19:09,718 - INFO - [test_dav_creation:497] - Verificando se a janela de autorização apareceu...
2025-09-05 11:19:10,311 - INFO - [test_dav_creation:148] - Pré-verificação (win32): Janela de autorização não apareceu.
2025-09-05 11:19:11,041 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:20:53,795 - ERROR - [test_dav_creation:536] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 517, in run
    dav_window.type_keys("{F1}")
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 11:20:55,967 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 11:20:55,967 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 11:20:57,884 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 11:20:57,884 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 11:20:57,909 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 11:20:57,909 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 11:20:57,910 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 11:20:57,916 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 11:20:59,279 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:20:59,279 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:20:59,280 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:20:59,284 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:20:59,293 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:21:01,074 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:21:01,075 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 4
2025-09-05 11:21:01,076 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:21:02,826 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:21:02,828 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:21:04,601 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:21:04,610 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:21:04,614 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:21:05,929 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:21:05,930 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:21:06,894 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:21:06,895 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:21:07,615 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:21:07,616 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:21:12,942 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 11:21:12,947 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:21:12,953 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:21:12,953 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:21:15,953 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:21:15,960 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:21:16,173 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:21:16,187 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:21:16,188 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:21:16,755 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:21:17,863 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:21:17,863 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:21:18,229 - INFO - [test_dav_creation:315] -    -> Natureza 'VIN' inserida.
2025-09-05 11:21:18,230 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:21:18,231 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:21:18,234 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:21:18,249 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:21:18,462 - INFO - [test_dav_creation:331] -    -> Cliente '379' inserido.
2025-09-05 11:21:18,515 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:21:18,531 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:21:18,594 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:21:18,610 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:21:19,713 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 11:21:19,713 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:21:19,713 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:21:19,714 - INFO - [test_dav_creation:365] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:21:19,993 - INFO - [test_dav_creation:369] -    -> Vendedor '504' inserido.
2025-09-05 11:21:21,085 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:21:21,085 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:21:21,234 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:21:21,234 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 11:21:21,249 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:21:21,445 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:21:21,445 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:21:21,504 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:21:22,004 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:21:22,012 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:21:22,016 - INFO - [test_dav_creation:424] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:21:22,016 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:21:22,016 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:21:22,016 - INFO - [test_dav_creation:431] -    -> Lançando produto: 9
2025-09-05 11:21:22,032 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:21:22,034 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:21:22,264 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:21:22,573 - INFO - [test_dav_creation:476] - Estoque disponível: 29. Quantidade sorteada: 3
2025-09-05 11:21:22,890 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:21:22,894 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:21:23,413 - INFO - [test_dav_creation:499] - Verificando se a janela de autorização apareceu...
2025-09-05 11:21:25,464 - INFO - [test_dav_creation:151] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 11:21:26,028 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:21:44,216 - INFO - [test_dav_creation:520] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:21:45,415 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:21:45,428 - INFO - [test_dav_creation:534] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 11:21:45,428 - INFO - [test_dav_creation:535] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 11:21:50,695 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:21:50,695 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:21:50,697 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:21:50,701 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:21:50,701 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:21:52,988 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:21:52,989 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 4
2025-09-05 11:21:52,993 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:21:55,561 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:21:55,562 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:21:57,842 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:21:57,844 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:21:57,847 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:21:59,474 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:21:59,475 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:22:00,578 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:22:00,597 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:22:01,721 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:22:01,765 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:22:07,456 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['9']
2025-09-05 11:22:07,460 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:22:07,465 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:22:07,466 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:22:10,466 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:22:10,492 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:22:10,703 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:22:10,717 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:22:10,718 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:22:10,933 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:22:12,097 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:22:12,097 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:22:12,354 - INFO - [test_dav_creation:315] -    -> Natureza 'VIN' inserida.
2025-09-05 11:22:12,354 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:22:12,355 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:22:12,359 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:22:12,374 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:22:12,571 - INFO - [test_dav_creation:331] -    -> Cliente '379' inserido.
2025-09-05 11:22:12,631 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:22:12,649 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:22:12,739 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:22:12,755 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:22:13,824 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 11:22:13,825 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:22:13,825 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:22:13,825 - INFO - [test_dav_creation:365] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:22:14,173 - INFO - [test_dav_creation:369] -    -> Vendedor '504' inserido.
2025-09-05 11:22:15,264 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:22:15,265 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:22:15,362 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:22:15,386 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 11:22:15,403 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:22:15,593 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:22:15,593 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:22:15,651 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:22:16,152 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:22:16,153 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:22:16,155 - INFO - [test_dav_creation:424] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:22:16,156 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:22:16,156 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:22:16,156 - INFO - [test_dav_creation:431] -    -> Lançando produto: 9
2025-09-05 11:22:16,176 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:22:16,180 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:22:16,410 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:22:16,719 - INFO - [test_dav_creation:476] - Estoque disponível: 29. Quantidade sorteada: 13
2025-09-05 11:22:16,990 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:22:16,994 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:22:17,518 - INFO - [test_dav_creation:499] - Verificando se a janela de autorização apareceu...
2025-09-05 11:22:17,558 - INFO - [test_dav_creation:148] - Pré-verificação (win32): Janela de autorização detectada.
2025-09-05 11:22:17,558 - INFO - [test_dav_creation:167] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 11:22:31,782 - INFO - [test_dav_creation:174] - Janela de autorização encontrada: 'Solicitação de Autorização para permissão Código: 107'
2025-09-05 11:22:48,185 - INFO - [test_dav_creation:180] - Botão '<< Autorizar' encontrado. Acionando com .invoke()...
2025-09-05 11:22:52,369 - INFO - [test_dav_creation:182] - --> Ação 'invoke' no botão '<< Autorizar' enviada.
2025-09-05 11:23:05,935 - INFO - [test_dav_creation:188] - Botão 'Confirma Autorização' encontrado. Acionando com .invoke()...
2025-09-05 11:23:10,019 - INFO - [test_dav_creation:190] - --> Ação 'invoke' no botão 'Confirma Autorização' enviada.
2025-09-05 11:23:12,253 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:23:21,863 - INFO - [test_dav_creation:520] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:23:23,152 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:23:23,152 - INFO - [test_dav_creation:534] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 11:23:23,152 - INFO - [test_dav_creation:535] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 11:24:33,119 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:24:33,120 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:24:33,121 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:24:33,123 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:24:33,124 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:24:35,339 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 5
2025-09-05 11:24:35,339 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 5
2025-09-05 11:24:35,344 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:24:37,684 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:24:37,685 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:24:40,161 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-05 11:24:40,163 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:24:40,166 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:24:41,641 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:24:41,644 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:24:42,785 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:24:42,786 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:24:45,929 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:24:45,930 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:25:10,442 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['233', '544']
2025-09-05 11:25:10,444 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:25:10,506 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:25:10,506 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:25:13,507 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:25:13,573 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:25:13,783 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:25:13,798 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:25:13,799 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:25:14,019 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:25:15,092 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:25:15,092 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:25:15,348 - INFO - [test_dav_creation:315] -    -> Natureza 'VIN' inserida.
2025-09-05 11:25:15,355 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:25:15,364 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:25:15,367 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:25:15,381 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:25:15,600 - INFO - [test_dav_creation:331] -    -> Cliente '65820' inserido.
2025-09-05 11:25:16,707 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 11:25:17,708 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:25:18,803 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 11:25:18,803 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:25:18,803 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:25:18,803 - INFO - [test_dav_creation:365] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:25:18,909 - INFO - [test_dav_creation:369] -    -> Vendedor '504' inserido.
2025-09-05 11:25:20,000 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:25:20,001 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:25:20,101 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:25:20,102 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 11:25:20,117 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:25:20,346 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:25:20,346 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:25:20,508 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:25:21,008 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:25:21,009 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:25:21,012 - INFO - [test_dav_creation:424] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:25:21,012 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:25:21,013 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:25:21,013 - INFO - [test_dav_creation:431] -    -> Lançando produto: 233
2025-09-05 11:25:21,055 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:21,058 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:25:21,289 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:25:21,625 - INFO - [test_dav_creation:476] - Estoque disponível: 10. Quantidade sorteada: 1
2025-09-05 11:25:21,884 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:21,898 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:21,901 - INFO - [test_dav_creation:431] -    -> Lançando produto: 544
2025-09-05 11:25:21,937 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:21,940 - INFO - [test_dav_creation:448] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 11:25:22,259 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:25:22,657 - INFO - [test_dav_creation:476] - Estoque disponível: 7. Quantidade sorteada: 4
2025-09-05 11:25:22,878 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:22,881 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:25:22,883 - INFO - [test_dav_creation:534] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 11:25:22,884 - INFO - [test_dav_creation:535] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 11:26:47,238 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:26:47,239 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:26:47,245 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:26:47,249 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:26:47,250 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:26:48,953 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:26:48,953 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 4
2025-09-05 11:26:48,954 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:26:51,044 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:26:51,046 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:26:52,665 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:26:52,666 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:26:52,673 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:26:54,387 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:26:54,388 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:26:55,462 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:26:55,476 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:26:56,244 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:26:56,279 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:27:08,353 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['7', '8', '10', '11']
2025-09-05 11:27:08,355 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:27:08,360 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:27:08,360 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:27:11,361 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:27:11,368 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:27:11,579 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:27:11,764 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:27:11,765 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:27:12,857 - ERROR - [test_dav_creation:538] - Ocorreu um erro durante o teste de criação de DAV: timed out
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 303, in run
    dav_window.wait('visible', timeout=1)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 529, in wait
    wait_until(timeout, retry_interval,
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
               lambda: self.__check_all_conditions(check_method_names, retry_interval))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 375, in wait_until
    raise err
pywinauto.timings.TimeoutError: timed out
2025-09-05 11:27:18,582 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:27:18,583 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:27:18,588 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:27:18,591 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:27:18,592 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:27:20,373 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:27:20,374 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 4
2025-09-05 11:27:20,387 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:27:22,043 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:27:22,050 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:27:23,551 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:27:23,552 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:27:23,570 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:27:26,109 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:27:26,110 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:27:27,329 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:27:27,333 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:27:28,276 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:27:28,278 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:27:35,700 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['7', '8', '10', '11']
2025-09-05 11:27:35,702 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:27:35,707 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:27:35,707 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:27:38,708 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:27:38,829 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:27:39,042 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:27:39,058 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:27:39,058 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:27:39,643 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:27:40,660 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:27:40,661 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:27:41,016 - INFO - [test_dav_creation:315] -    -> Natureza 'VIN' inserida.
2025-09-05 11:27:41,016 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:27:41,028 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:27:41,032 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:27:41,048 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:27:41,257 - INFO - [test_dav_creation:331] -    -> Cliente '379' inserido.
2025-09-05 11:27:41,307 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:27:41,324 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:27:41,393 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:27:41,409 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:27:42,534 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 11:27:42,573 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:27:42,573 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:27:42,573 - INFO - [test_dav_creation:365] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:27:42,853 - INFO - [test_dav_creation:369] -    -> Vendedor '504' inserido.
2025-09-05 11:27:43,857 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:27:43,857 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:27:43,957 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:27:43,957 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 11:27:43,972 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:27:44,226 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:27:44,226 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:27:44,284 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:27:44,784 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:27:44,785 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:27:44,789 - INFO - [test_dav_creation:424] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:27:44,789 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:27:44,789 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:27:44,789 - INFO - [test_dav_creation:431] -    -> Lançando produto: 7
2025-09-05 11:27:44,805 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:27:44,808 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:27:45,040 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:27:45,481 - INFO - [test_dav_creation:476] - Estoque disponível: 24. Quantidade sorteada: 1
2025-09-05 11:27:45,701 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:27:45,707 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:27:46,341 - INFO - [test_dav_creation:499] - Verificando se a janela de autorização apareceu...
2025-09-05 11:27:48,432 - INFO - [test_dav_creation:151] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 11:27:48,993 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:28:25,226 - ERROR - [test_dav_creation:538] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 519, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91887002>, 'backend': 'win32'}
2025-09-05 11:29:35,423 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 11:29:35,423 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 11:30:42,743 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 11:30:42,744 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 11:30:42,762 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 11:30:42,762 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 11:30:42,763 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 11:30:42,770 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 11:30:44,222 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 11:30:44,223 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 11:30:44,224 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 11:30:44,228 - INFO - [test_dav_creation:217] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 11:30:44,230 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 11:30:46,641 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 11:30:46,641 - INFO - [test_dav_creation:221] - Trabalhando com a filial: 4
2025-09-05 11:30:46,645 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 11:30:49,088 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 11:30:49,090 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 11:30:50,987 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 11:30:50,988 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:30:50,992 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 11:30:52,352 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 11:30:52,356 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 11:30:53,375 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 11:30:53,518 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 11:30:54,485 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 11:30:54,490 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 11:31:07,321 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['10', '11', '15', '16']
2025-09-05 11:31:07,323 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 11:31:07,329 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 11:31:07,330 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 11:31:10,330 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 11:31:10,339 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 11:31:10,551 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 11:31:10,566 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 11:31:10,566 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 11:31:11,127 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 11:31:12,145 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:31:12,145 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 11:31:12,398 - INFO - [test_dav_creation:315] -    -> Natureza 'VIN' inserida.
2025-09-05 11:31:12,399 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 11:31:12,399 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:31:12,403 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 11:31:12,418 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 11:31:12,999 - INFO - [test_dav_creation:331] -    -> Cliente '379' inserido.
2025-09-05 11:31:13,050 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 11:31:13,065 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:31:13,132 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:31:13,148 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:31:14,234 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 11:31:14,234 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 11:31:14,235 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 11:31:14,235 - INFO - [test_dav_creation:365] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 11:31:14,587 - INFO - [test_dav_creation:369] -    -> Vendedor '504' inserido.
2025-09-05 11:31:15,679 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 11:31:15,679 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 11:31:15,780 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 11:31:15,780 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 11:31:15,796 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 11:31:16,026 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '113' inserida.
2025-09-05 11:31:16,027 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 11:31:16,086 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 11:31:16,586 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 11:31:16,588 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 11:31:16,591 - INFO - [test_dav_creation:424] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 11:31:16,591 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 11:31:16,591 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 11:31:16,591 - INFO - [test_dav_creation:431] -    -> Lançando produto: 10
2025-09-05 11:31:16,617 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:16,620 - INFO - [test_dav_creation:448] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 11:31:16,840 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:31:17,249 - INFO - [test_dav_creation:478] - Estoque disponível: 208. Quantidade sorteada: 11
2025-09-05 11:31:17,514 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:17,529 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:18,128 - INFO - [test_dav_creation:501] - Verificando se a janela de autorização apareceu...
2025-09-05 11:31:20,161 - INFO - [test_dav_creation:151] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 11:31:20,721 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:31:31,255 - INFO - [test_dav_creation:522] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:31:32,480 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:31:32,480 - INFO - [test_dav_creation:431] -    -> Lançando produto: 11
2025-09-05 11:31:32,506 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:32,509 - INFO - [test_dav_creation:448] - Produto tem 3 unidade(s) mapeada(s).
2025-09-05 11:31:33,024 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:31:33,273 - INFO - [test_dav_creation:478] - Estoque disponível: 23. Quantidade sorteada: 4
2025-09-05 11:31:33,522 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:33,531 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:31:34,054 - INFO - [test_dav_creation:501] - Verificando se a janela de autorização apareceu...
2025-09-05 11:31:34,086 - INFO - [test_dav_creation:148] - Pré-verificação (win32): Janela de autorização detectada.
2025-09-05 11:31:34,086 - INFO - [test_dav_creation:167] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 11:31:48,360 - INFO - [test_dav_creation:174] - Janela de autorização encontrada: 'Solicitação de Autorização para permissão Código: 107'
2025-09-05 11:32:05,611 - INFO - [test_dav_creation:180] - Botão '<< Autorizar' encontrado. Acionando com .invoke()...
2025-09-05 11:32:10,176 - INFO - [test_dav_creation:182] - --> Ação 'invoke' no botão '<< Autorizar' enviada.
2025-09-05 11:32:23,551 - INFO - [test_dav_creation:188] - Botão 'Confirma Autorização' encontrado. Acionando com .invoke()...
2025-09-05 11:32:27,794 - INFO - [test_dav_creation:190] - --> Ação 'invoke' no botão 'Confirma Autorização' enviada.
2025-09-05 11:32:29,025 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:32:40,623 - INFO - [test_dav_creation:522] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:32:41,063 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 11:32:41,078 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 11:32:41,078 - INFO - [test_dav_creation:431] -    -> Lançando produto: 15
2025-09-05 11:32:41,589 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:41,600 - INFO - [test_dav_creation:448] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 11:32:41,861 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:32:42,206 - INFO - [test_dav_creation:478] - Estoque disponível: 184. Quantidade sorteada: 16
2025-09-05 11:32:42,484 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:42,487 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:43,009 - INFO - [test_dav_creation:501] - Verificando se a janela de autorização apareceu...
2025-09-05 11:32:45,018 - INFO - [test_dav_creation:151] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 11:32:45,577 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:32:53,159 - INFO - [test_dav_creation:522] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:32:54,476 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:32:54,477 - INFO - [test_dav_creation:431] -    -> Lançando produto: 16
2025-09-05 11:32:54,511 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:54,514 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 11:32:55,037 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 11:32:55,321 - INFO - [test_dav_creation:478] - Estoque disponível: 145. Quantidade sorteada: 5
2025-09-05 11:32:55,582 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:55,585 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 11:32:56,108 - INFO - [test_dav_creation:501] - Verificando se a janela de autorização apareceu...
2025-09-05 11:32:58,337 - INFO - [test_dav_creation:151] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 11:32:58,897 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 11:33:06,831 - INFO - [test_dav_creation:522] - Pressionando ENTER 2x para gravar o item.
2025-09-05 11:33:08,123 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 11:33:08,123 - INFO - [test_dav_creation:536] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 11:33:08,123 - INFO - [test_dav_creation:537] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:04:40,109 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 12:04:40,110 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 12:04:43,611 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:04:43,611 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:04:43,638 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:04:43,638 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:04:43,639 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:04:43,650 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:04:44,750 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:04:44,750 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:04:44,752 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:04:44,757 - INFO - [test_dav_creation:224] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:04:44,758 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:04:48,163 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:04:48,165 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:04:51,084 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:04:51,087 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:04:51,093 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:04:52,089 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:04:52,091 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:04:52,828 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:04:52,829 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:05:37,257 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['3', '1884', '1927', '1931']
2025-09-05 12:05:37,259 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:05:37,271 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:05:37,272 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 12:05:40,272 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:05:40,278 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:05:40,500 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:05:40,516 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:05:40,516 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:05:41,212 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:05:42,320 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:05:42,320 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:05:42,574 - INFO - [test_dav_creation:315] -    -> Natureza 'VEN' inserida.
2025-09-05 12:05:42,575 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:05:42,576 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:05:42,580 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:05:42,594 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:05:42,796 - INFO - [test_dav_creation:331] -    -> Cliente '3751' inserido.
2025-09-05 12:05:43,904 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:05:44,996 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:05:46,082 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 12:05:46,082 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:05:46,082 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:05:46,082 - INFO - [test_dav_creation:359] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:05:47,384 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:05:47,385 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:05:47,668 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:05:47,669 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 12:05:47,684 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:05:47,795 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:05:47,795 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:05:47,854 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:05:48,355 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:05:48,357 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:05:48,370 - INFO - [test_dav_creation:122] - Diálogo 'Confirmação' encontrado.
2025-09-05 12:05:48,408 - INFO - [test_dav_creation:126] - --> Combinação de teclas '%(s)' enviada com sucesso.
2025-09-05 12:05:48,408 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:05:48,409 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:05:48,409 - INFO - [test_dav_creation:431] -    -> Lançando produto: 3
2025-09-05 12:05:48,619 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:49,715 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:05:49,716 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:05:50,243 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:05:50,249 - INFO - [test_dav_creation:478] - Estoque disponível: 12. Quantidade sorteada: 6
2025-09-05 12:05:50,469 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:50,473 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:50,477 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:05:50,517 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1884
2025-09-05 12:05:50,993 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:52,091 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:05:52,092 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:05:52,526 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:05:52,532 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:05:52,752 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:52,763 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:52,768 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:05:52,822 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1927
2025-09-05 12:05:53,267 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:54,373 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:05:54,373 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:05:54,809 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:05:54,812 - INFO - [test_dav_creation:478] - Estoque disponível: 5. Quantidade sorteada: 3
2025-09-05 12:05:55,036 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:55,043 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:55,046 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:05:55,084 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1931
2025-09-05 12:05:55,461 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:56,555 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:05:56,555 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:05:56,989 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:05:56,995 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:05:57,218 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:57,225 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:05:57,228 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:05:57,340 - INFO - [test_dav_creation:536] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:05:57,340 - INFO - [test_dav_creation:537] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:08:40,237 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:08:40,238 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:08:40,239 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:08:40,245 - INFO - [test_dav_creation:224] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:08:40,246 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:08:43,614 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:08:43,618 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:08:46,255 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:08:46,259 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:08:46,266 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:09:14,027 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:09:14,029 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:09:15,260 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:09:15,264 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:10:02,512 - INFO - [test_dav_creation:98] - Usuário selecionou 20 itens: ['3', '1884', '1925', '1926', '1927', '1930', '1931', '1933', '1934', '1935', '1936', '1938', '1940', '1941', '1942', '1944', '1945', '1947', '1948', '1949']
2025-09-05 12:10:02,514 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:10:02,522 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:10:02,522 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 12:10:05,522 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:10:05,528 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:10:05,740 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:10:05,754 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:10:05,754 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:10:06,046 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:10:07,154 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:10:07,154 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:10:07,237 - INFO - [test_dav_creation:315] -    -> Natureza 'VEN' inserida.
2025-09-05 12:10:07,237 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:10:07,239 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:07,248 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:10:07,262 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:10:07,474 - INFO - [test_dav_creation:331] -    -> Cliente '3751' inserido.
2025-09-05 12:10:08,581 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:10:09,673 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:10:10,676 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 12:10:10,676 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:10:10,676 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:10:10,676 - INFO - [test_dav_creation:359] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:10:11,803 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:10:11,803 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:10:12,057 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:10:12,057 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 12:10:12,073 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:10:12,134 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:10:12,134 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:10:12,193 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:10:12,693 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:10:12,695 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:10:13,793 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:10:13,793 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:10:13,794 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:10:13,794 - INFO - [test_dav_creation:431] -    -> Lançando produto: 3
2025-09-05 12:10:13,811 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:14,906 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:14,906 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:15,430 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:15,435 - INFO - [test_dav_creation:478] - Estoque disponível: 12. Quantidade sorteada: 12
2025-09-05 12:10:15,818 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:15,860 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:15,864 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:16,013 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1884
2025-09-05 12:10:16,397 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:17,495 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:17,495 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:18,039 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:18,049 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:18,428 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:18,470 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:18,477 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:18,562 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1925
2025-09-05 12:10:19,090 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:20,187 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:20,187 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:20,624 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:20,630 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:20,996 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:21,002 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:21,006 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:21,063 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1926
2025-09-05 12:10:21,404 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:22,501 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:22,501 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:22,989 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:22,994 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:23,356 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:23,363 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:23,368 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:23,408 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1927
2025-09-05 12:10:24,117 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:25,215 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:25,215 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:25,663 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:25,673 - INFO - [test_dav_creation:478] - Estoque disponível: 5. Quantidade sorteada: 4
2025-09-05 12:10:26,045 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:26,052 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:26,056 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:26,095 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1930
2025-09-05 12:10:26,638 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:27,777 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:27,777 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:28,213 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:28,217 - INFO - [test_dav_creation:478] - Estoque disponível: 11. Quantidade sorteada: 6
2025-09-05 12:10:28,591 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:28,597 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:28,601 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:28,759 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1931
2025-09-05 12:10:29,328 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:30,340 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:30,340 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:30,776 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:30,838 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:31,159 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:31,165 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:31,170 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:31,291 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1933
2025-09-05 12:10:31,847 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:32,855 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:32,855 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:33,290 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:33,295 - INFO - [test_dav_creation:478] - Estoque disponível: 4. Quantidade sorteada: 2
2025-09-05 12:10:33,671 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:33,678 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:33,683 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:33,801 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1934
2025-09-05 12:10:34,330 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:35,428 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:35,428 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:35,864 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:35,868 - INFO - [test_dav_creation:478] - Estoque disponível: 12. Quantidade sorteada: 12
2025-09-05 12:10:36,264 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:36,271 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:36,276 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:36,314 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1935
2025-09-05 12:10:36,819 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:37,916 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:37,916 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:38,355 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:38,360 - INFO - [test_dav_creation:478] - Estoque disponível: 9. Quantidade sorteada: 1
2025-09-05 12:10:38,737 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:38,744 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:38,748 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:38,806 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1936
2025-09-05 12:10:39,345 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:40,443 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:40,443 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:41,005 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:41,010 - INFO - [test_dav_creation:478] - Estoque disponível: 35. Quantidade sorteada: 4
2025-09-05 12:10:41,456 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:41,466 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:41,472 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:41,511 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1938
2025-09-05 12:10:41,851 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:42,946 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:42,946 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:43,382 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:43,386 - INFO - [test_dav_creation:478] - Estoque disponível: 3. Quantidade sorteada: 3
2025-09-05 12:10:43,764 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:43,771 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:43,776 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:43,840 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1940
2025-09-05 12:10:44,376 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:45,384 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:45,385 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:45,822 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:45,826 - INFO - [test_dav_creation:478] - Estoque disponível: 118. Quantidade sorteada: 2
2025-09-05 12:10:46,206 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:46,212 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:46,215 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:46,344 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1941
2025-09-05 12:10:46,877 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:47,974 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:47,975 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:48,410 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:48,449 - INFO - [test_dav_creation:478] - Estoque disponível: 27. Quantidade sorteada: 5
2025-09-05 12:10:48,837 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:48,844 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:48,849 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:48,888 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1942
2025-09-05 12:10:49,423 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:50,521 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:50,521 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:51,046 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:51,051 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:51,477 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:51,484 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:51,489 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:51,528 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1944
2025-09-05 12:10:51,875 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:52,883 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:52,883 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:53,322 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:53,327 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:10:53,704 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:53,711 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:53,715 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:53,860 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1945
2025-09-05 12:10:54,421 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:55,427 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:55,428 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:55,866 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:55,872 - INFO - [test_dav_creation:478] - Estoque disponível: 26. Quantidade sorteada: 9
2025-09-05 12:10:56,250 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:56,261 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:56,267 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:56,352 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1947
2025-09-05 12:10:56,748 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:57,845 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:10:57,845 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:10:58,315 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:10:58,321 - INFO - [test_dav_creation:478] - Estoque disponível: 3. Quantidade sorteada: 2
2025-09-05 12:10:58,700 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:58,707 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:10:58,711 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:10:58,753 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1948
2025-09-05 12:10:59,279 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:00,287 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:11:00,287 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:11:00,842 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:11:00,848 - INFO - [test_dav_creation:478] - Estoque disponível: 13. Quantidade sorteada: 9
2025-09-05 12:11:01,223 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:01,230 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:01,235 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:11:01,275 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1949
2025-09-05 12:11:01,486 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:02,583 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:11:02,584 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:11:03,020 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:11:03,024 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:11:03,405 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:03,412 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:11:03,416 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:11:03,460 - INFO - [test_dav_creation:536] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:11:03,460 - INFO - [test_dav_creation:537] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:11:43,485 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:11:43,486 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:11:43,487 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:11:43,492 - INFO - [test_dav_creation:224] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:11:43,493 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:11:46,882 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:11:46,884 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:11:57,024 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:11:57,034 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:11:57,045 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:11:59,251 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:11:59,253 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:12:00,572 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:12:00,574 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:12:34,803 - INFO - [test_dav_creation:98] - Usuário selecionou 17 itens: ['3', '1884', '1925', '1926', '1927', '1930', '1934', '1976', '2488', '2743', '2746', '2747', '3146', '3358', '3361', '3436', '3439']
2025-09-05 12:12:34,809 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:12:34,820 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:12:34,820 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 12:12:37,821 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:12:37,951 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:12:38,161 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:12:38,178 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:12:38,178 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:12:38,714 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:12:39,732 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:12:39,732 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:12:39,986 - INFO - [test_dav_creation:315] -    -> Natureza 'VEN' inserida.
2025-09-05 12:12:39,986 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:12:39,987 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:39,993 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:12:40,009 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:12:40,197 - INFO - [test_dav_creation:331] -    -> Cliente '3751' inserido.
2025-09-05 12:12:41,306 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:12:42,307 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:12:43,398 - INFO - [test_dav_creation:353] - Tela de endereços não foi encontrada script continua
2025-09-05 12:12:43,398 - INFO - [test_dav_creation:356] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:12:43,398 - INFO - [test_dav_creation:357] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:12:43,398 - INFO - [test_dav_creation:359] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:12:44,699 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:12:44,699 - INFO - [test_dav_creation:391] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:12:45,143 - INFO - [test_dav_creation:395] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:12:45,144 - INFO - [test_dav_creation:398] - Passo 13: Pressionando ENTER.
2025-09-05 12:12:45,159 - INFO - [test_dav_creation:402] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:12:45,219 - INFO - [test_dav_creation:405] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:12:45,220 - INFO - [test_dav_creation:408] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:12:45,278 - INFO - [test_dav_creation:410] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:12:45,778 - INFO - [test_dav_creation:413] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:12:45,780 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:12:46,877 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:12:46,877 - INFO - [test_dav_creation:427] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:12:46,877 - INFO - [test_dav_creation:428] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:12:46,877 - INFO - [test_dav_creation:431] -    -> Lançando produto: 3
2025-09-05 12:12:46,895 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:47,992 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:47,993 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:12:48,430 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:48,435 - INFO - [test_dav_creation:478] - Estoque disponível: 12. Quantidade sorteada: 8
2025-09-05 12:12:48,655 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:48,662 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:48,666 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:12:48,707 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1884
2025-09-05 12:12:48,757 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:49,863 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:49,863 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:12:50,646 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:50,651 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:12:50,871 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:50,876 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:50,881 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:12:50,922 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1925
2025-09-05 12:12:50,969 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:51,975 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:51,975 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:12:52,483 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:52,488 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:12:52,708 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:52,714 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:52,719 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:12:52,790 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1926
2025-09-05 12:12:52,838 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:53,935 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:53,935 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:12:54,467 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:54,473 - INFO - [test_dav_creation:478] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:12:54,692 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:54,698 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:54,701 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:12:54,790 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1927
2025-09-05 12:12:54,838 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:55,934 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:55,935 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:12:56,797 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:12:56,804 - INFO - [test_dav_creation:478] - Estoque disponível: 5. Quantidade sorteada: 2
2025-09-05 12:12:57,024 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:57,030 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:57,044 - INFO - [test_dav_creation:532] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:12:57,086 - INFO - [test_dav_creation:431] -    -> Lançando produto: 1930
2025-09-05 12:12:57,134 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:12:58,140 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:12:58,140 - INFO - [test_dav_creation:448] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:13:03,842 - ERROR - [test_dav_creation:540] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 15862020>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 452, in run
    dav_window.type_keys('{ENTER}')
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 15862020>, 'backend': 'win32'}
2025-09-05 12:15:19,669 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 12:15:19,669 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 12:24:39,861 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:24:39,862 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:24:39,888 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:24:39,888 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:24:39,889 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:24:39,904 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:24:41,269 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:24:41,269 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:24:41,271 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:24:41,277 - INFO - [test_dav_creation:224] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:24:41,279 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:24:45,279 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:24:45,281 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:24:48,960 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:24:48,963 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:24:48,970 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:24:50,012 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:24:50,026 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:24:50,680 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:24:50,683 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:25:03,755 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['3']
2025-09-05 12:25:03,757 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:25:03,770 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:25:03,770 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 12:25:06,771 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:25:06,777 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:25:06,989 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:25:07,004 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:25:07,004 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:25:07,487 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:25:08,506 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:25:08,506 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:25:08,761 - INFO - [test_dav_creation:315] -    -> Natureza 'VEN' inserida.
2025-09-05 12:25:08,762 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:25:08,764 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:25:08,770 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:25:08,784 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:25:08,964 - INFO - [test_dav_creation:331] -    -> Cliente '3751' inserido.
2025-09-05 12:25:10,070 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:25:11,162 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:25:13,157 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:25:14,202 - INFO - [test_dav_creation:356] - Tela de endereços não foi encontrada script continua
2025-09-05 12:25:14,203 - INFO - [test_dav_creation:359] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:25:14,203 - INFO - [test_dav_creation:360] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:25:14,203 - INFO - [test_dav_creation:362] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:25:15,411 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:25:15,411 - INFO - [test_dav_creation:394] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:25:15,854 - INFO - [test_dav_creation:398] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:25:15,855 - INFO - [test_dav_creation:401] - Passo 13: Pressionando ENTER.
2025-09-05 12:25:15,871 - INFO - [test_dav_creation:405] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:25:15,932 - INFO - [test_dav_creation:408] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:25:15,932 - INFO - [test_dav_creation:411] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:25:15,990 - INFO - [test_dav_creation:413] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:25:16,491 - INFO - [test_dav_creation:416] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:25:16,493 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:25:17,589 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:25:17,589 - INFO - [test_dav_creation:430] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:25:17,589 - INFO - [test_dav_creation:431] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:25:17,590 - INFO - [test_dav_creation:434] -    -> Lançando produto: 3
2025-09-05 12:25:17,606 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:25:18,704 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:25:18,705 - INFO - [test_dav_creation:451] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:25:19,146 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:25:19,152 - INFO - [test_dav_creation:481] - Estoque disponível: 12. Quantidade sorteada: 9
2025-09-05 12:25:19,372 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:25:19,378 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:25:19,382 - INFO - [test_dav_creation:535] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:25:19,421 - INFO - [test_dav_creation:539] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:25:19,421 - INFO - [test_dav_creation:540] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:26:19,453 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 12:26:19,453 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 12:26:26,777 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:26:26,778 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:26:26,796 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:26:26,796 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:26:26,798 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:26:26,815 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:26:40,294 - INFO - [test_dav_creation:205] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:26:40,294 - INFO - [test_dav_creation:211] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:26:40,299 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:26:40,307 - INFO - [test_dav_creation:224] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:26:40,308 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:26:43,983 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:26:43,986 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:26:51,714 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:26:51,718 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:26:51,731 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:26:55,734 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:26:55,736 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:26:56,824 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:26:56,826 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:27:01,793 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['3']
2025-09-05 12:27:01,795 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:27:01,803 - INFO - [test_dav_creation:276] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:27:01,803 - INFO - [test_dav_creation:277] - A automação da interface começará em 3 segundos...
2025-09-05 12:27:04,804 - INFO - [test_dav_creation:284] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:27:04,926 - INFO - [test_dav_creation:289] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:27:05,137 - INFO - [test_dav_creation:294] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:27:05,152 - INFO - [test_dav_creation:298] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:27:05,152 - INFO - [test_dav_creation:301] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:27:05,632 - INFO - [test_dav_creation:305] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:27:06,739 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:27:06,739 - INFO - [test_dav_creation:312] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:27:07,029 - INFO - [test_dav_creation:315] -    -> Natureza 'VEN' inserida.
2025-09-05 12:27:07,029 - INFO - [test_dav_creation:318] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:27:07,031 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:27:07,035 - INFO - [test_dav_creation:324] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:27:07,050 - INFO - [test_dav_creation:328] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:27:07,228 - INFO - [test_dav_creation:331] -    -> Cliente '3751' inserido.
2025-09-05 12:27:08,336 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:27:09,427 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:27:11,122 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:27:12,140 - INFO - [test_dav_creation:356] - Tela de endereços não foi encontrada script continua
2025-09-05 12:27:12,140 - INFO - [test_dav_creation:359] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:27:12,140 - INFO - [test_dav_creation:360] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:27:12,140 - INFO - [test_dav_creation:362] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:27:13,419 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:27:14,697 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:27:14,697 - INFO - [test_dav_creation:396] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:27:14,966 - INFO - [test_dav_creation:400] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:27:14,966 - INFO - [test_dav_creation:403] - Passo 13: Pressionando ENTER.
2025-09-05 12:27:14,982 - INFO - [test_dav_creation:407] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:27:15,044 - INFO - [test_dav_creation:410] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:27:15,045 - INFO - [test_dav_creation:413] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:27:15,104 - INFO - [test_dav_creation:415] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:27:15,604 - INFO - [test_dav_creation:418] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:27:15,606 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:27:16,706 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:27:16,706 - INFO - [test_dav_creation:432] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:27:16,707 - INFO - [test_dav_creation:433] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:27:16,707 - INFO - [test_dav_creation:436] -    -> Lançando produto: 3
2025-09-05 12:27:16,723 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:27:17,731 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:27:17,731 - INFO - [test_dav_creation:453] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:27:18,340 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:27:18,347 - INFO - [test_dav_creation:483] - Estoque disponível: 12. Quantidade sorteada: 10
2025-09-05 12:27:18,577 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:27:18,585 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:27:18,590 - INFO - [test_dav_creation:537] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:27:18,631 - INFO - [test_dav_creation:541] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:27:18,631 - INFO - [test_dav_creation:542] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:27:26,821 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 12:27:26,822 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 12:35:51,600 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:35:51,600 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:35:51,618 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:35:51,619 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:35:51,620 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:35:51,632 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:35:55,701 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:35:55,702 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:35:55,704 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:35:55,709 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:35:55,710 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:35:58,990 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:35:58,992 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:36:02,041 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3751
2025-09-05 12:36:02,043 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:02,050 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:36:04,623 - ERROR - [test_dav_creation:49] - Nenhum item foi selecionado ou a janela foi fechada.
2025-09-05 12:36:04,624 - ERROR - [test_dav_creation:546] - Ocorreu um erro durante o teste de criação de DAV: Seleção de Forma de Pagamento foi cancelada.
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 252, in run
    if not selected_forma_pg_code: raise ValueError("Seleção de Forma de Pagamento foi cancelada.")
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Seleção de Forma de Pagamento foi cancelada.
2025-09-05 12:36:06,269 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:36:06,269 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:36:06,271 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:36:06,276 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:36:06,278 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:36:08,595 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:36:08,597 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:36:10,712 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 7818
2025-09-05 12:36:10,717 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:10,733 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:36:11,722 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:36:11,724 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:36:12,998 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:36:13,010 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:36:25,425 - INFO - [test_dav_creation:98] - Usuário selecionou 12 itens: ['3', '1884', '1925', '1926', '1927', '1930', '1931', '1933', '1934', '1935', '1936', '1938']
2025-09-05 12:36:25,434 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:36:25,449 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:36:25,449 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 12:36:28,450 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:36:28,575 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:36:28,788 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:36:28,802 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:36:28,802 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:36:29,325 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:36:30,341 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:36:30,341 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:36:30,596 - INFO - [test_dav_creation:316] -    -> Natureza 'VEN' inserida.
2025-09-05 12:36:30,596 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:36:30,598 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:30,604 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:36:30,620 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:36:30,805 - INFO - [test_dav_creation:332] -    -> Cliente '7818' inserido.
2025-09-05 12:36:31,912 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:36:32,913 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:36:34,819 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:36:36,023 - INFO - [test_dav_creation:357] - Tela de endereços não foi encontrada script continua
2025-09-05 12:36:36,023 - INFO - [test_dav_creation:360] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:36:36,023 - INFO - [test_dav_creation:361] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:36:36,023 - INFO - [test_dav_creation:363] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:36:37,303 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:36:38,491 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:36:38,491 - INFO - [test_dav_creation:397] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:36:38,690 - INFO - [test_dav_creation:401] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:36:38,690 - INFO - [test_dav_creation:404] - Passo 13: Pressionando ENTER.
2025-09-05 12:36:38,705 - INFO - [test_dav_creation:408] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:36:38,781 - INFO - [test_dav_creation:411] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:36:38,781 - INFO - [test_dav_creation:414] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:36:38,839 - INFO - [test_dav_creation:416] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:36:39,340 - INFO - [test_dav_creation:419] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:36:39,342 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:36:40,439 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:36:40,440 - INFO - [test_dav_creation:433] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:36:40,440 - INFO - [test_dav_creation:434] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:36:40,440 - INFO - [test_dav_creation:437] -    -> Lançando produto: 3
2025-09-05 12:36:40,635 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:42,020 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:42,086 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:42,525 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:42,532 - INFO - [test_dav_creation:484] - Estoque disponível: 12. Quantidade sorteada: 5
2025-09-05 12:36:42,754 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:42,765 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:42,770 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:42,809 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1884
2025-09-05 12:36:42,861 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:43,958 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:43,958 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:44,398 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:44,405 - INFO - [test_dav_creation:484] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:36:44,625 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:44,635 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:44,642 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:44,684 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1925
2025-09-05 12:36:44,733 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:45,873 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:45,873 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:46,308 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:46,315 - INFO - [test_dav_creation:484] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:36:46,536 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:46,543 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:46,546 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:46,588 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1926
2025-09-05 12:36:46,636 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:47,734 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:47,734 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:48,170 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:48,176 - INFO - [test_dav_creation:484] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:36:48,398 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:48,406 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:48,409 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:48,449 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1927
2025-09-05 12:36:48,500 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:49,505 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:49,505 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:49,944 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:49,949 - INFO - [test_dav_creation:484] - Estoque disponível: 5. Quantidade sorteada: 3
2025-09-05 12:36:50,170 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:50,528 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:50,531 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:50,571 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1930
2025-09-05 12:36:50,620 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:51,719 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:51,798 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:52,237 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:52,242 - INFO - [test_dav_creation:484] - Estoque disponível: 11. Quantidade sorteada: 2
2025-09-05 12:36:52,467 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:52,474 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:52,478 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:52,519 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1931
2025-09-05 12:36:52,580 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:53,678 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:53,678 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:54,119 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:54,126 - INFO - [test_dav_creation:484] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:36:54,346 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:54,360 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:54,366 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:54,407 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1933
2025-09-05 12:36:54,455 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:55,556 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:55,556 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:55,997 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:56,003 - INFO - [test_dav_creation:484] - Estoque disponível: 4. Quantidade sorteada: 4
2025-09-05 12:36:56,222 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:56,228 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:56,231 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:56,272 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1934
2025-09-05 12:36:56,320 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:57,419 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:57,419 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:57,854 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:57,860 - INFO - [test_dav_creation:484] - Estoque disponível: 12. Quantidade sorteada: 1
2025-09-05 12:36:58,079 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:58,086 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:58,090 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:36:58,129 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1935
2025-09-05 12:36:58,177 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:36:59,284 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:36:59,284 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:36:59,894 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:36:59,900 - INFO - [test_dav_creation:484] - Estoque disponível: 9. Quantidade sorteada: 1
2025-09-05 12:37:00,145 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:00,172 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:00,182 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:37:00,230 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1936
2025-09-05 12:37:00,278 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:01,377 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:37:01,378 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:37:01,993 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:37:01,999 - INFO - [test_dav_creation:484] - Estoque disponível: 35. Quantidade sorteada: 19
2025-09-05 12:37:02,230 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:02,239 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:02,244 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:37:02,283 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1938
2025-09-05 12:37:02,332 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:03,430 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:37:03,430 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:37:03,874 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:37:03,965 - INFO - [test_dav_creation:484] - Estoque disponível: 3. Quantidade sorteada: 1
2025-09-05 12:37:04,186 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:04,193 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:37:04,200 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:37:04,241 - INFO - [test_dav_creation:542] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:37:04,241 - INFO - [test_dav_creation:543] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:40:38,428 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:40:38,429 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:40:38,430 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:40:38,436 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:40:38,437 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:40:41,439 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:40:41,442 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:40:45,600 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 2144
2025-09-05 12:40:45,605 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:40:45,614 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:40:46,803 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:40:46,806 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:40:49,309 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:40:49,312 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:40:59,101 - INFO - [test_dav_creation:98] - Usuário selecionou 6 itens: ['3', '1884', '1925', '1926', '1927', '1930']
2025-09-05 12:40:59,104 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:40:59,113 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:40:59,113 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 12:41:02,114 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:41:02,180 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:41:02,398 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:41:02,415 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:41:02,415 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:41:02,649 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:41:03,679 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:41:03,679 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:41:03,941 - INFO - [test_dav_creation:316] -    -> Natureza 'VEN' inserida.
2025-09-05 12:41:03,941 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:41:03,942 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:41:03,947 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:41:03,967 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:41:04,146 - INFO - [test_dav_creation:332] -    -> Cliente '2144' inserido.
2025-09-05 12:41:05,177 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:41:06,194 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:41:08,098 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:41:09,140 - INFO - [test_dav_creation:357] - Tela de endereços não foi encontrada script continua
2025-09-05 12:41:09,140 - INFO - [test_dav_creation:360] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:41:09,140 - INFO - [test_dav_creation:361] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:41:09,140 - INFO - [test_dav_creation:363] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:41:10,338 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:41:11,599 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:41:11,599 - INFO - [test_dav_creation:397] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:41:11,733 - INFO - [test_dav_creation:401] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:41:11,733 - INFO - [test_dav_creation:404] - Passo 13: Pressionando ENTER.
2025-09-05 12:41:11,751 - INFO - [test_dav_creation:408] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:41:11,858 - INFO - [test_dav_creation:411] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:41:11,858 - INFO - [test_dav_creation:414] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:41:11,919 - INFO - [test_dav_creation:416] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:41:12,419 - INFO - [test_dav_creation:419] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:41:12,423 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:41:13,436 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:41:13,436 - INFO - [test_dav_creation:433] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:41:13,436 - INFO - [test_dav_creation:434] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:41:13,436 - INFO - [test_dav_creation:437] -    -> Lançando produto: 3
2025-09-05 12:41:13,634 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:14,653 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:41:14,653 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:41:15,097 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:41:15,102 - INFO - [test_dav_creation:484] - Estoque disponível: 12. Quantidade sorteada: 3
2025-09-05 12:41:15,328 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:15,333 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:15,338 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:41:15,384 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1884
2025-09-05 12:41:15,436 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:16,450 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:41:16,451 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:41:16,896 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:41:17,225 - INFO - [test_dav_creation:484] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:41:17,451 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:17,458 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:17,462 - INFO - [test_dav_creation:538] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:41:17,511 - INFO - [test_dav_creation:437] -    -> Lançando produto: 1925
2025-09-05 12:41:17,562 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:41:18,577 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:41:18,577 - INFO - [test_dav_creation:454] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:44:13,647 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:44:13,647 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:44:13,663 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:44:13,663 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:44:13,664 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:44:13,678 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:44:15,692 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:44:15,692 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:44:15,720 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:44:15,724 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:44:15,725 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:44:18,321 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:44:18,331 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:44:30,880 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 2144
2025-09-05 12:44:30,884 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:44:30,892 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:44:31,781 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:44:31,963 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:44:37,767 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:44:37,768 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:44:42,876 - INFO - [test_dav_creation:98] - Usuário selecionou 2 itens: ['3', '1884']
2025-09-05 12:44:42,882 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:44:42,904 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:44:42,904 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 12:44:45,904 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:44:45,910 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:44:46,124 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:44:46,138 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:44:46,138 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:44:46,630 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:44:47,646 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:44:47,647 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:44:48,002 - INFO - [test_dav_creation:316] -    -> Natureza 'VEN' inserida.
2025-09-05 12:44:48,002 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:44:48,004 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:44:48,009 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:44:48,025 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:44:48,208 - INFO - [test_dav_creation:332] -    -> Cliente '2144' inserido.
2025-09-05 12:44:49,226 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 12:44:50,228 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:44:52,097 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:44:53,285 - INFO - [test_dav_creation:357] - Tela de endereços não foi encontrada script continua
2025-09-05 12:44:53,285 - INFO - [test_dav_creation:360] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:44:53,285 - INFO - [test_dav_creation:361] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:44:53,286 - INFO - [test_dav_creation:363] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:44:54,576 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:44:54,577 - INFO - [test_dav_creation:395] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:44:54,972 - INFO - [test_dav_creation:399] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:44:55,020 - INFO - [test_dav_creation:402] - Passo 13: Pressionando ENTER.
2025-09-05 12:44:55,037 - INFO - [test_dav_creation:406] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:44:55,112 - INFO - [test_dav_creation:409] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:44:55,112 - INFO - [test_dav_creation:412] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:44:55,170 - INFO - [test_dav_creation:414] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:44:55,671 - INFO - [test_dav_creation:417] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:44:55,673 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:44:56,771 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:44:56,771 - INFO - [test_dav_creation:431] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:44:56,771 - INFO - [test_dav_creation:432] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:44:56,771 - INFO - [test_dav_creation:435] -    -> Lançando produto: 3
2025-09-05 12:44:56,959 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:44:58,056 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:44:58,056 - INFO - [test_dav_creation:452] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:44:58,495 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:44:58,501 - INFO - [test_dav_creation:482] - Estoque disponível: 12. Quantidade sorteada: 8
2025-09-05 12:44:58,723 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:44:58,730 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:44:58,733 - INFO - [test_dav_creation:536] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:44:58,771 - INFO - [test_dav_creation:435] -    -> Lançando produto: 1884
2025-09-05 12:44:58,820 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:44:59,827 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:44:59,827 - INFO - [test_dav_creation:452] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:45:00,436 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:45:00,519 - INFO - [test_dav_creation:482] - Estoque disponível: 1. Quantidade sorteada: 1
2025-09-05 12:45:00,739 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:45:00,747 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:45:00,752 - INFO - [test_dav_creation:536] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:45:00,792 - INFO - [test_dav_creation:540] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:45:00,792 - INFO - [test_dav_creation:541] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 12:45:08,581 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 12:45:08,581 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 12:45:46,522 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 12:45:46,522 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 12:45:46,542 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 12:45:46,542 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 12:45:46,543 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 12:45:46,554 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 12:45:48,036 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 12:45:48,037 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 12:45:48,043 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 12:45:48,049 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 12:45:48,050 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 12:45:50,904 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VEN
2025-09-05 12:45:50,906 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 12:45:54,408 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 3477
2025-09-05 12:45:54,411 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:45:54,425 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 12:45:55,503 - INFO - [test_dav_creation:47] - Usuário selecionou o código: PIX
2025-09-05 12:45:55,583 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 12:45:56,529 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 1
2025-09-05 12:45:56,621 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 12:46:01,287 - INFO - [test_dav_creation:98] - Usuário selecionou 1 itens: ['3']
2025-09-05 12:46:01,289 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 12:46:01,297 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 12:46:01,297 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 12:46:04,298 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 12:46:04,428 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 12:46:04,640 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 12:46:04,657 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 12:46:04,658 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 12:46:05,183 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 12:46:06,290 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:46:06,490 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 12:46:06,746 - INFO - [test_dav_creation:316] -    -> Natureza 'VEN' inserida.
2025-09-05 12:46:06,747 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 12:46:06,749 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:46:06,755 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 12:46:06,770 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 12:46:06,948 - INFO - [test_dav_creation:332] -    -> Cliente '3477' inserido.
2025-09-05 12:46:07,965 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-05 12:46:09,689 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 12:46:10,693 - INFO - [test_dav_creation:354] - Tela de endereços não foi encontrada script continua
2025-09-05 12:46:10,693 - INFO - [test_dav_creation:357] - Passo 9: Verificando configuração do vendedor...
2025-09-05 12:46:10,694 - INFO - [test_dav_creation:358] -    -> Valor de Nat_cfgvendedor: 1
2025-09-05 12:46:10,694 - INFO - [test_dav_creation:360] -    -> CfgVendedor = 1. Pressionando ENTER para selecionar vendedor padrão e ENTER 2X para chegar ao lançamento da forma de pagamento.
2025-09-05 12:46:11,893 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:46:11,893 - INFO - [test_dav_creation:392] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 12:46:12,720 - INFO - [test_dav_creation:396] -    -> Forma de pagamento 'PIX' inserida.
2025-09-05 12:46:12,720 - INFO - [test_dav_creation:399] - Passo 13: Pressionando ENTER.
2025-09-05 12:46:12,736 - INFO - [test_dav_creation:403] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 12:46:12,840 - INFO - [test_dav_creation:406] -    -> Condição de pagamento '1' inserida.
2025-09-05 12:46:12,841 - INFO - [test_dav_creation:409] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 12:46:12,899 - INFO - [test_dav_creation:411] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 12:46:13,400 - INFO - [test_dav_creation:414] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 12:46:13,402 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 12:46:14,496 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 12:46:14,497 - INFO - [test_dav_creation:428] - Passo 17: Iniciando lançamento de itens...
2025-09-05 12:46:14,497 - INFO - [test_dav_creation:429] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 12:46:14,497 - INFO - [test_dav_creation:432] -    -> Lançando produto: 3
2025-09-05 12:46:14,514 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:46:15,610 - INFO - [test_dav_creation:130] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-09-05 12:46:15,611 - INFO - [test_dav_creation:449] - Produto tem 2 unidade(s) mapeada(s).
2025-09-05 12:46:16,177 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 12:46:16,200 - INFO - [test_dav_creation:479] - Estoque disponível: 12. Quantidade sorteada: 11
2025-09-05 12:46:16,432 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:46:16,438 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 12:46:16,443 - INFO - [test_dav_creation:533] - Pressionando ENTER 3x para gravar o item.
2025-09-05 12:46:16,482 - INFO - [test_dav_creation:537] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 12:46:16,482 - INFO - [test_dav_creation:538] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-05 14:13:57,201 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:13:57,201 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:13:57,220 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:13:57,220 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:13:57,221 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:13:57,231 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-09-05 14:14:03,697 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:14:03,698 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:14:03,699 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:14:03,706 - INFO - [test_dav_creation:225] - Encontrada uma única filial ativa: 1. Selecionada automaticamente.
2025-09-05 14:14:03,707 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:14:10,250 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:14:10,251 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:14:14,684 - ERROR - [test_dav_creation:49] - Nenhum item foi selecionado ou a janela foi fechada.
2025-09-05 14:14:14,685 - ERROR - [test_dav_creation:541] - Ocorreu um erro durante o teste de criação de DAV: Seleção de Cliente foi cancelada.
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 237, in run
    if not selected_cliente_code: raise ValueError("Seleção de Cliente foi cancelada.")
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Seleção de Cliente foi cancelada.
2025-09-05 14:14:26,449 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 14:14:26,449 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 14:15:35,940 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:15:35,940 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:15:35,960 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:15:35,961 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:15:35,961 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:15:35,968 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 14:15:36,762 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:15:36,763 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:15:36,764 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:15:36,767 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 14:15:36,768 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 14:15:39,039 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 14:15:39,040 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 14:15:39,040 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:15:41,865 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:15:41,867 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:15:44,248 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 14:15:44,250 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:15:44,255 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 14:15:46,017 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 14:15:46,019 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 14:15:47,402 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 14:15:47,403 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 14:15:49,661 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 14:15:49,662 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 14:24:12,077 - WARNING - [test_dav_creation:100] - Nenhum item foi selecionado.
2025-09-05 14:24:12,079 - ERROR - [test_dav_creation:541] - Ocorreu um erro durante o teste de criação de DAV: Nenhum produto foi selecionado.
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 269, in run
    if not selected_products: raise ValueError("Nenhum produto foi selecionado.")
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Nenhum produto foi selecionado.
2025-09-05 14:24:16,546 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-05 14:24:16,546 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 14:25:23,233 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:25:23,233 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:25:23,252 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:25:23,252 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:25:23,253 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:25:23,261 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 14:25:28,833 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:25:28,833 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:25:28,834 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:25:28,838 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 14:25:28,839 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 14:25:31,043 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 14:25:31,044 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 14:25:31,046 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:25:33,751 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:25:33,756 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:25:36,138 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 14:25:36,140 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:25:36,145 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 14:25:39,167 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 14:25:39,169 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 14:25:41,889 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 14:25:41,890 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 14:25:46,050 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 14:25:46,051 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 14:27:17,943 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['19000', '13741', '13739']
2025-09-05 14:27:17,946 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 14:27:17,988 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 14:27:17,988 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 14:27:20,989 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 14:27:26,081 - ERROR - [test_dav_creation:541] - Ocorreu um erro durante o teste de criação de DAV: timed out
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 289, in run
    main_window.wait('visible', timeout=5)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 529, in wait
    wait_until(timeout, retry_interval,
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
               lambda: self.__check_all_conditions(check_method_names, retry_interval))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 375, in wait_until
    raise err
pywinauto.timings.TimeoutError: timed out
2025-09-05 14:27:30,761 - INFO - [db_handler:367] - Fechando pool de conexões com o MySQL.
2025-09-05 14:27:30,761 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 14:28:02,451 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:28:02,451 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:28:02,478 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:28:02,478 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:28:02,479 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:28:02,484 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 14:28:03,689 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:28:03,689 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:28:03,690 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:28:03,694 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 14:28:03,694 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 14:28:05,527 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 14:28:05,527 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 14:28:05,528 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:28:07,238 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:28:07,239 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:28:08,807 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 14:28:08,808 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:28:08,812 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 14:28:10,743 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 14:28:10,745 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 14:28:34,249 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 14:28:34,251 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 14:28:35,579 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 14:28:35,581 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 14:28:57,813 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['19000', '13741', '13739']
2025-09-05 14:28:57,816 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 14:28:57,824 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 14:28:57,824 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 14:29:00,825 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 14:29:00,832 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 14:29:01,045 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 14:29:01,060 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 14:29:01,060 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 14:29:01,632 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 14:29:02,650 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:29:02,650 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 14:29:02,903 - INFO - [test_dav_creation:316] -    -> Natureza 'VIN' inserida.
2025-09-05 14:29:02,904 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 14:29:02,905 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:29:02,908 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 14:29:02,922 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 14:29:03,133 - INFO - [test_dav_creation:332] -    -> Cliente '379' inserido.
2025-09-05 14:29:03,189 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 14:29:03,206 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 14:29:04,894 - INFO - [test_dav_creation:130] - Diálogo opcional 'Aviso' não apareceu. Prosseguindo...
2025-09-05 14:29:05,987 - INFO - [test_dav_creation:354] - Tela de endereços não foi encontrada script continua
2025-09-05 14:29:05,987 - INFO - [test_dav_creation:357] - Passo 9: Verificando configuração do vendedor...
2025-09-05 14:29:05,987 - INFO - [test_dav_creation:358] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 14:29:05,987 - INFO - [test_dav_creation:366] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 14:29:06,266 - INFO - [test_dav_creation:370] -    -> Vendedor '504' inserido.
2025-09-05 14:29:07,359 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:29:07,359 - INFO - [test_dav_creation:392] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 14:29:07,444 - INFO - [test_dav_creation:396] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 14:29:07,444 - INFO - [test_dav_creation:399] - Passo 13: Pressionando ENTER.
2025-09-05 14:29:07,462 - INFO - [test_dav_creation:403] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 14:29:07,549 - INFO - [test_dav_creation:406] -    -> Condição de pagamento '113' inserida.
2025-09-05 14:29:07,549 - INFO - [test_dav_creation:409] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 14:29:07,607 - INFO - [test_dav_creation:411] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 14:29:08,108 - INFO - [test_dav_creation:414] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 14:29:08,160 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 14:29:08,165 - INFO - [test_dav_creation:425] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 14:29:08,165 - INFO - [test_dav_creation:428] - Passo 17: Iniciando lançamento de itens...
2025-09-05 14:29:08,165 - INFO - [test_dav_creation:429] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 14:29:08,165 - INFO - [test_dav_creation:432] -    -> Lançando produto: 19000
2025-09-05 14:29:08,222 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:29:08,225 - INFO - [test_dav_creation:449] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 14:29:08,445 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:29:08,671 - INFO - [test_dav_creation:479] - Estoque disponível: 33. Quantidade sorteada: 14
2025-09-05 14:29:08,902 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:29:08,910 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:29:09,434 - INFO - [test_dav_creation:502] - Verificando se a janela de autorização apareceu...
2025-09-05 14:29:11,523 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 14:29:12,083 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 14:29:22,562 - INFO - [db_handler:367] - Fechando pool de conexões com o MySQL.
2025-09-05 14:29:22,562 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 14:31:31,789 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:31:31,789 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:31:31,810 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:31:31,810 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:31:31,811 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:31:31,818 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 14:31:33,177 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:31:33,178 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:31:33,179 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:31:33,182 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 14:31:33,183 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 14:31:35,043 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 14:31:35,044 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 14:31:35,045 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:31:37,694 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:31:37,695 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:31:39,433 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 14:31:39,434 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:31:39,439 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 14:31:40,673 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 14:31:40,674 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 14:31:41,742 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 14:31:41,744 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 14:31:42,644 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 14:31:42,645 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 14:32:07,427 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['19000', '13741', '13739']
2025-09-05 14:32:07,429 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 14:32:07,435 - INFO - [test_dav_creation:277] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 14:32:07,435 - INFO - [test_dav_creation:278] - A automação da interface começará em 3 segundos...
2025-09-05 14:32:10,435 - INFO - [test_dav_creation:285] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 14:32:10,443 - INFO - [test_dav_creation:290] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 14:32:10,693 - INFO - [test_dav_creation:295] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 14:32:10,707 - INFO - [test_dav_creation:299] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 14:32:10,708 - INFO - [test_dav_creation:302] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 14:32:11,342 - INFO - [test_dav_creation:306] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 14:32:12,360 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:32:12,360 - INFO - [test_dav_creation:313] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 14:32:12,664 - INFO - [test_dav_creation:316] -    -> Natureza 'VIN' inserida.
2025-09-05 14:32:12,664 - INFO - [test_dav_creation:319] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 14:32:12,665 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:32:12,669 - INFO - [test_dav_creation:325] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 14:32:12,684 - INFO - [test_dav_creation:329] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 14:32:12,945 - INFO - [test_dav_creation:332] -    -> Cliente '379' inserido.
2025-09-05 14:32:13,002 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 14:32:13,018 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 14:32:13,087 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 14:32:13,105 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 14:32:14,166 - INFO - [test_dav_creation:354] - Tela de endereços não foi encontrada script continua
2025-09-05 14:32:14,166 - INFO - [test_dav_creation:357] - Passo 9: Verificando configuração do vendedor...
2025-09-05 14:32:14,166 - INFO - [test_dav_creation:358] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 14:32:14,166 - INFO - [test_dav_creation:366] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 14:32:14,446 - INFO - [test_dav_creation:370] -    -> Vendedor '504' inserido.
2025-09-05 14:32:15,456 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:32:15,457 - INFO - [test_dav_creation:392] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 14:32:15,556 - INFO - [test_dav_creation:396] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 14:32:15,556 - INFO - [test_dav_creation:399] - Passo 13: Pressionando ENTER.
2025-09-05 14:32:15,691 - INFO - [test_dav_creation:403] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 14:32:15,902 - INFO - [test_dav_creation:406] -    -> Condição de pagamento '113' inserida.
2025-09-05 14:32:15,902 - INFO - [test_dav_creation:409] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 14:32:15,960 - INFO - [test_dav_creation:411] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 14:32:16,460 - INFO - [test_dav_creation:414] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 14:32:16,461 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 14:32:16,465 - INFO - [test_dav_creation:425] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 14:32:16,465 - INFO - [test_dav_creation:428] - Passo 17: Iniciando lançamento de itens...
2025-09-05 14:32:16,465 - INFO - [test_dav_creation:429] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 14:32:16,465 - INFO - [test_dav_creation:432] -    -> Lançando produto: 19000
2025-09-05 14:32:16,523 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:32:16,639 - INFO - [test_dav_creation:449] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 14:32:16,895 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:32:17,351 - INFO - [test_dav_creation:479] - Estoque disponível: 33. Quantidade sorteada: 4
2025-09-05 14:32:17,611 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:32:17,616 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:32:18,254 - INFO - [test_dav_creation:502] - Verificando se a janela de autorização apareceu...
2025-09-05 14:32:20,343 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 14:32:21,073 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 14:32:50,458 - INFO - [db_handler:367] - Fechando pool de conexões com o MySQL.
2025-09-05 14:32:50,458 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 14:52:50,222 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 14:52:50,222 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 14:52:50,240 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 14:52:50,241 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 14:52:50,241 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 14:52:50,247 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 14:52:52,139 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 14:52:52,139 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 14:52:52,140 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 14:52:52,143 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 14:52:52,143 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 14:52:53,901 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 14:52:53,902 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 14:52:53,903 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 14:52:56,040 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 14:52:56,128 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 14:52:57,871 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 14:52:57,872 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:52:57,877 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 14:52:59,206 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 14:52:59,208 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 14:53:00,384 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 14:53:00,385 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 14:53:01,466 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 14:53:01,467 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 14:53:40,645 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['13741', '13739', '13509']
2025-09-05 14:53:40,649 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 14:53:40,672 - INFO - [test_dav_creation:277] - Buscando dados de fração mínima para os produtos selecionados...
2025-09-05 14:53:40,673 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 14:53:40,678 - INFO - [test_dav_creation:287] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 14:53:40,678 - INFO - [test_dav_creation:288] - A automação da interface começará em 3 segundos...
2025-09-05 14:53:43,679 - INFO - [test_dav_creation:295] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 14:53:43,687 - INFO - [test_dav_creation:300] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 14:53:43,898 - INFO - [test_dav_creation:305] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 14:53:43,914 - INFO - [test_dav_creation:309] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 14:53:43,914 - INFO - [test_dav_creation:312] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 14:53:44,208 - INFO - [test_dav_creation:316] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 14:53:45,315 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:53:45,316 - INFO - [test_dav_creation:323] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 14:53:45,697 - INFO - [test_dav_creation:326] -    -> Natureza 'VIN' inserida.
2025-09-05 14:53:45,697 - INFO - [test_dav_creation:329] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 14:53:45,698 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:53:45,700 - INFO - [test_dav_creation:335] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 14:53:45,714 - INFO - [test_dav_creation:339] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 14:53:45,919 - INFO - [test_dav_creation:342] -    -> Cliente '379' inserido.
2025-09-05 14:53:45,972 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 14:53:45,988 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 14:53:46,072 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 14:53:46,088 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 14:53:47,181 - INFO - [test_dav_creation:364] - Tela de endereços não foi encontrada script continua
2025-09-05 14:53:47,181 - INFO - [test_dav_creation:367] - Passo 9: Verificando configuração do vendedor...
2025-09-05 14:53:47,181 - INFO - [test_dav_creation:368] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 14:53:47,181 - INFO - [test_dav_creation:376] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 14:53:47,536 - INFO - [test_dav_creation:380] -    -> Vendedor '504' inserido.
2025-09-05 14:53:48,628 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 14:53:48,628 - INFO - [test_dav_creation:402] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 14:53:48,729 - INFO - [test_dav_creation:406] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 14:53:48,729 - INFO - [test_dav_creation:409] - Passo 13: Pressionando ENTER.
2025-09-05 14:53:48,745 - INFO - [test_dav_creation:413] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 14:53:48,949 - INFO - [test_dav_creation:416] -    -> Condição de pagamento '113' inserida.
2025-09-05 14:53:48,949 - INFO - [test_dav_creation:419] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 14:53:49,008 - INFO - [test_dav_creation:421] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 14:53:49,508 - INFO - [test_dav_creation:424] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 14:53:49,510 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 14:53:49,514 - INFO - [test_dav_creation:435] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 14:53:49,514 - INFO - [test_dav_creation:438] - Passo 17: Iniciando lançamento de itens...
2025-09-05 14:53:49,514 - INFO - [test_dav_creation:439] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 14:53:49,514 - INFO - [test_dav_creation:442] -    -> Lançando produto: 13741
2025-09-05 14:53:49,573 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 14:53:49,577 - INFO - [test_dav_creation:459] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 14:53:49,798 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 14:53:50,233 - ERROR - [test_dav_creation:569] - Ocorreu um erro durante o teste de criação de DAV: cannot access local variable 'frac_minima' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 506, in run
    logging.info(f"Estoque: {available_stock}. Fração Mínima: {frac_minima}. Quantidade final lançada: {random_quantity}")
                                                               ^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'frac_minima' where it is not associated with a value
2025-09-05 14:59:59,480 - INFO - [db_handler:385] - Fechando pool de conexões com o MySQL.
2025-09-05 14:59:59,481 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 15:00:02,552 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 15:00:02,552 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 15:00:02,570 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 15:00:02,570 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 15:00:02,571 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 15:00:02,576 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 15:00:09,089 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 15:00:09,090 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 15:00:09,092 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 15:00:09,095 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 15:00:09,096 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 15:00:17,631 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 15:00:17,631 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 15:00:17,632 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 15:00:21,065 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 15:00:21,066 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 15:00:22,602 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 15:00:22,625 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:00:22,630 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 15:00:24,019 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 15:00:24,020 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 15:00:25,167 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 15:00:25,168 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 15:00:25,906 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 15:00:25,926 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 15:00:58,046 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['19000', '13741', '13739']
2025-09-05 15:00:58,049 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 15:00:58,054 - INFO - [test_dav_creation:278] - Buscando dados de fração mínima para os produtos selecionados...
2025-09-05 15:00:58,055 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 15:00:58,060 - INFO - [test_dav_creation:288] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 15:00:58,060 - INFO - [test_dav_creation:289] - A automação da interface começará em 3 segundos...
2025-09-05 15:01:01,061 - INFO - [test_dav_creation:296] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 15:01:01,124 - INFO - [test_dav_creation:301] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 15:01:01,336 - INFO - [test_dav_creation:306] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 15:01:01,354 - INFO - [test_dav_creation:310] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 15:01:01,354 - INFO - [test_dav_creation:313] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 15:01:01,570 - INFO - [test_dav_creation:317] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 15:01:02,640 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 15:01:02,640 - INFO - [test_dav_creation:324] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 15:01:02,932 - INFO - [test_dav_creation:327] -    -> Natureza 'VIN' inserida.
2025-09-05 15:01:02,932 - INFO - [test_dav_creation:330] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 15:01:02,933 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:01:02,936 - INFO - [test_dav_creation:336] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 15:01:02,951 - INFO - [test_dav_creation:340] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 15:01:03,210 - INFO - [test_dav_creation:343] -    -> Cliente '379' inserido.
2025-09-05 15:01:03,264 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 15:01:03,281 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 15:01:03,370 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 15:01:03,387 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 15:01:04,425 - INFO - [test_dav_creation:365] - Tela de endereços não foi encontrada script continua
2025-09-05 15:01:04,425 - INFO - [test_dav_creation:368] - Passo 9: Verificando configuração do vendedor...
2025-09-05 15:01:04,425 - INFO - [test_dav_creation:369] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 15:01:04,425 - INFO - [test_dav_creation:377] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 15:01:04,757 - INFO - [test_dav_creation:381] -    -> Vendedor '504' inserido.
2025-09-05 15:01:05,848 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 15:01:05,848 - INFO - [test_dav_creation:403] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 15:01:05,950 - INFO - [test_dav_creation:407] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 15:01:05,950 - INFO - [test_dav_creation:410] - Passo 13: Pressionando ENTER.
2025-09-05 15:01:05,966 - INFO - [test_dav_creation:414] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 15:01:06,224 - INFO - [test_dav_creation:417] -    -> Condição de pagamento '113' inserida.
2025-09-05 15:01:06,224 - INFO - [test_dav_creation:420] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 15:01:06,282 - INFO - [test_dav_creation:422] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 15:01:06,783 - INFO - [test_dav_creation:425] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 15:01:06,784 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 15:01:06,787 - INFO - [test_dav_creation:436] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 15:01:06,788 - INFO - [test_dav_creation:439] - Passo 17: Iniciando lançamento de itens...
2025-09-05 15:01:06,788 - INFO - [test_dav_creation:440] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 15:01:06,788 - INFO - [test_dav_creation:443] -    -> Lançando produto: 19000
2025-09-05 15:01:06,846 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:01:06,849 - INFO - [test_dav_creation:460] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 15:01:07,070 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:01:07,479 - INFO - [test_dav_creation:505] - Estoque: 33. Fração Mínima: 2.773. Quantidade final lançada: 30.503
2025-09-05 15:01:07,782 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:01:07,786 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:01:08,343 - INFO - [test_dav_creation:528] - Verificando se a janela de autorização apareceu...
2025-09-05 15:01:08,386 - INFO - [test_dav_creation:149] - Pré-verificação (win32): Janela de autorização detectada.
2025-09-05 15:01:08,386 - INFO - [test_dav_creation:168] - Conectando com backend 'uia' para tratar a janela de autorização...
2025-09-05 15:01:22,755 - INFO - [test_dav_creation:175] - Janela de autorização encontrada: 'Solicitação de Autorização para permissão Código: 107'
2025-09-05 15:01:39,710 - INFO - [test_dav_creation:181] - Botão '<< Autorizar' encontrado. Acionando com .invoke()...
2025-09-05 15:01:43,993 - INFO - [test_dav_creation:183] - --> Ação 'invoke' no botão '<< Autorizar' enviada.
2025-09-05 15:01:56,772 - INFO - [test_dav_creation:189] - Botão 'Confirma Autorização' encontrado. Acionando com .invoke()...
2025-09-05 15:02:01,058 - INFO - [test_dav_creation:191] - --> Ação 'invoke' no botão 'Confirma Autorização' enviada.
2025-09-05 15:02:01,840 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 15:02:11,314 - INFO - [test_dav_creation:549] - Pressionando ENTER 2x para gravar o item.
2025-09-05 15:02:12,515 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 15:02:12,515 - INFO - [test_dav_creation:443] -    -> Lançando produto: 13741
2025-09-05 15:02:12,744 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:02:12,748 - INFO - [test_dav_creation:460] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 15:02:12,973 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:02:13,868 - INFO - [test_dav_creation:505] - Estoque: 1139. Fração Mínima: 1.0. Quantidade final lançada: 500.0
2025-09-05 15:02:14,219 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:02:14,225 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:02:14,746 - INFO - [test_dav_creation:528] - Verificando se a janela de autorização apareceu...
2025-09-05 15:02:16,838 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 15:02:17,397 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 15:03:31,407 - ERROR - [test_dav_creation:567] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_17P9c000000, 3409972>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 548, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\testes-automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_17P9c000000, 3409972>, 'backend': 'win32'}
2025-09-05 15:03:34,920 - INFO - [db_handler:385] - Fechando pool de conexões com o MySQL.
2025-09-05 15:03:34,920 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-05 15:25:47,875 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-05 15:25:47,876 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-05 15:25:47,894 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-05 15:25:47,895 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-05 15:25:47,895 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-05 15:25:47,902 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-05 15:25:49,007 - INFO - [test_dav_creation:206] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-05 15:25:49,008 - INFO - [test_dav_creation:212] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-05 15:25:49,010 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-05 15:25:49,015 - INFO - [test_dav_creation:218] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-05 15:25:49,016 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-05 15:25:50,664 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-05 15:25:50,665 - INFO - [test_dav_creation:222] - Trabalhando com a filial: 4
2025-09-05 15:25:50,666 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-05 15:25:52,616 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-05 15:25:52,617 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-05 15:25:54,270 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-05 15:25:54,271 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:25:54,277 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-05 15:25:55,823 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-05 15:25:55,825 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-05 15:25:56,799 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-05 15:25:56,800 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-05 15:25:57,555 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-05 15:25:57,559 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-05 15:26:15,506 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['19000', '13741', '13739']
2025-09-05 15:26:15,509 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 15:26:15,514 - INFO - [test_dav_creation:278] - Buscando dados de fração mínima para os produtos selecionados...
2025-09-05 15:26:15,515 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-05 15:26:15,519 - INFO - [test_dav_creation:288] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-05 15:26:15,519 - INFO - [test_dav_creation:289] - A automação da interface começará em 3 segundos...
2025-09-05 15:26:18,519 - INFO - [test_dav_creation:296] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-05 15:26:18,596 - INFO - [test_dav_creation:301] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-05 15:26:18,808 - INFO - [test_dav_creation:306] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-05 15:26:18,823 - INFO - [test_dav_creation:310] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-05 15:26:18,823 - INFO - [test_dav_creation:313] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-05 15:26:19,412 - INFO - [test_dav_creation:317] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-05 15:26:20,520 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 15:26:20,520 - INFO - [test_dav_creation:324] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-05 15:26:20,806 - INFO - [test_dav_creation:327] -    -> Natureza 'VIN' inserida.
2025-09-05 15:26:20,806 - INFO - [test_dav_creation:330] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-05 15:26:20,807 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:26:20,811 - INFO - [test_dav_creation:336] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-05 15:26:20,826 - INFO - [test_dav_creation:340] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-05 15:26:21,035 - INFO - [test_dav_creation:343] -    -> Cliente '379' inserido.
2025-09-05 15:26:21,088 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-05 15:26:21,105 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 15:26:21,185 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 15:26:21,203 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 15:26:22,329 - INFO - [test_dav_creation:365] - Tela de endereços não foi encontrada script continua
2025-09-05 15:26:22,329 - INFO - [test_dav_creation:368] - Passo 9: Verificando configuração do vendedor...
2025-09-05 15:26:22,329 - INFO - [test_dav_creation:369] -    -> Valor de Nat_cfgvendedor: 3
2025-09-05 15:26:22,329 - INFO - [test_dav_creation:377] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-05 15:26:22,613 - INFO - [test_dav_creation:381] -    -> Vendedor '504' inserido.
2025-09-05 15:26:23,705 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-05 15:26:23,705 - INFO - [test_dav_creation:403] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-05 15:26:23,909 - INFO - [test_dav_creation:407] -    -> Forma de pagamento 'DH' inserida.
2025-09-05 15:26:23,909 - INFO - [test_dav_creation:410] - Passo 13: Pressionando ENTER.
2025-09-05 15:26:23,924 - INFO - [test_dav_creation:414] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-05 15:26:24,130 - INFO - [test_dav_creation:417] -    -> Condição de pagamento '113' inserida.
2025-09-05 15:26:24,130 - INFO - [test_dav_creation:420] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-05 15:26:24,191 - INFO - [test_dav_creation:422] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-05 15:26:24,691 - INFO - [test_dav_creation:425] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-05 15:26:24,692 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-05 15:26:24,702 - INFO - [test_dav_creation:436] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-05 15:26:24,702 - INFO - [test_dav_creation:439] - Passo 17: Iniciando lançamento de itens...
2025-09-05 15:26:24,702 - INFO - [test_dav_creation:440] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-05 15:26:24,702 - INFO - [test_dav_creation:443] -    -> Lançando produto: 19000
2025-09-05 15:26:24,762 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:24,766 - INFO - [test_dav_creation:460] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 15:26:24,987 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:26:25,410 - INFO - [test_dav_creation:505] - Estoque: 33. Fração Mínima: 2.773. Quantidade final lançada: 16.638
2025-09-05 15:26:25,717 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:25,741 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:26,264 - INFO - [test_dav_creation:529] - Verificando se a janela de autorização apareceu...
2025-09-05 15:26:28,407 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 15:26:28,970 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 15:26:37,272 - INFO - [test_dav_creation:550] - Pressionando ENTER 2x para gravar o item.
2025-09-05 15:26:38,474 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 15:26:38,474 - INFO - [test_dav_creation:443] -    -> Lançando produto: 13741
2025-09-05 15:26:38,533 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:38,536 - INFO - [test_dav_creation:460] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 15:26:38,756 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:26:39,186 - INFO - [test_dav_creation:505] - Estoque: 1139. Fração Mínima: 1.0. Quantidade final lançada: 400.0
2025-09-05 15:26:39,480 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:39,484 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:40,005 - INFO - [test_dav_creation:529] - Verificando se a janela de autorização apareceu...
2025-09-05 15:26:42,193 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 15:26:42,758 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 15:26:52,690 - INFO - [test_dav_creation:550] - Pressionando ENTER 2x para gravar o item.
2025-09-05 15:26:53,262 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-05 15:26:53,279 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-05 15:26:53,280 - INFO - [test_dav_creation:443] -    -> Lançando produto: 13739
2025-09-05 15:26:53,861 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:53,865 - INFO - [test_dav_creation:460] - Produto tem 1 unidade(s) mapeada(s).
2025-09-05 15:26:54,102 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-05 15:26:54,543 - INFO - [test_dav_creation:505] - Estoque: 365. Fração Mínima: 1.0. Quantidade final lançada: 110.0
2025-09-05 15:26:54,836 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:54,841 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-05 15:26:55,422 - INFO - [test_dav_creation:529] - Verificando se a janela de autorização apareceu...
2025-09-05 15:26:57,447 - INFO - [test_dav_creation:152] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-09-05 15:26:58,009 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-05 15:27:04,600 - INFO - [test_dav_creation:550] - Pressionando ENTER 2x para gravar o item.
2025-09-05 15:27:05,892 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-05 15:27:05,892 - INFO - [test_dav_creation:564] - Todos os itens selecionados foram lançados com sucesso.
2025-09-05 15:27:05,892 - INFO - [test_dav_creation:565] - ### TESTE CONCLUÍDO: Criação de DAV ###
