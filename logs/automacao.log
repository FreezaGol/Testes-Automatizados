2025-10-01 09:50:14,548 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 09:50:14,550 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 09:50:14,579 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 09:50:14,579 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 09:50:14,580 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 09:50:14,626 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 09:50:29,026 - INFO - [test_dav_creation_new:140] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 09:50:29,027 - INFO - [test_dav_creation_new:144] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 09:50:29,028 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 09:50:30,107 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 09:50:32,410 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 09:50:32,412 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 09:50:35,779 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 09:50:35,781 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 09:50:40,913 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 09:50:40,916 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 09:50:40,932 - INFO - [test_dav_creation_new:169] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 09:50:40,935 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 09:50:43,729 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 09:50:43,731 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 09:50:45,441 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 09:50:45,443 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 09:50:56,585 - INFO - [test_dav_creation_new:77] - Usuário selecionou 2 itens: ['2291', '36']
2025-10-01 09:50:56,588 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 09:50:56,603 - INFO - [test_dav_creation_new:214] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 09:50:56,607 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 09:50:56,655 - INFO - [test_dav_creation_new:223] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 09:50:56,655 - INFO - [test_dav_creation_new:226] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 09:51:00,643 - INFO - [test_dav_creation_new:234] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 09:51:00,701 - INFO - [test_dav_creation_new:237] - Navegado para a seção 'Vendas'.
2025-10-01 09:51:02,771 - ERROR - [test_dav_creation_new:345] - Ocorreu um erro durante o teste de criação de DAV: timed out
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 240, in run
    dav_consult_window.wait('visible', timeout=0.50).set_focus().type_keys('{F2}')
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 529, in wait
    wait_until(timeout, retry_interval,
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
               lambda: self.__check_all_conditions(check_method_names, retry_interval))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 375, in wait_until
    raise err
pywinauto.timings.TimeoutError: timed out
2025-10-01 09:51:18,323 - INFO - [test_dav_creation_new:140] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 09:51:18,323 - INFO - [test_dav_creation_new:144] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 09:51:18,325 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 09:51:18,332 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 09:51:19,712 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 09:51:19,713 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 09:51:21,669 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 09:51:21,676 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 09:51:23,800 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 09:51:23,802 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 09:51:23,811 - INFO - [test_dav_creation_new:169] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 09:51:23,812 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 09:51:24,976 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 09:51:24,978 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 09:51:26,629 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 09:51:26,631 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 09:51:33,608 - INFO - [test_dav_creation_new:77] - Usuário selecionou 3 itens: ['2291', '2129', '1651']
2025-10-01 09:51:33,610 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 09:51:33,623 - INFO - [test_dav_creation_new:214] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 09:51:33,625 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 09:51:33,630 - INFO - [test_dav_creation_new:223] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 09:51:33,630 - INFO - [test_dav_creation_new:226] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 09:51:37,536 - INFO - [test_dav_creation_new:234] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 09:51:37,593 - INFO - [test_dav_creation_new:237] - Navegado para a seção 'Vendas'.
2025-10-01 09:51:55,158 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 09:51:55,159 - INFO - [test_dav_creation_new:248] - Preenchendo Natureza: VEE
2025-10-01 09:52:01,720 - INFO - [test_dav_creation_new:252] - Preenchendo Cliente: 2463
2025-10-01 09:52:09,704 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 09:52:10,296 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 09:52:10,297 - INFO - [test_dav_creation_new:259] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 09:52:10,297 - INFO - [test_dav_creation_new:262] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 09:52:14,781 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 09:52:15,373 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 09:52:15,373 - INFO - [test_dav_creation_new:274] - Preenchendo Forma de Pagamento: BL
2025-10-01 09:52:22,495 - INFO - [test_dav_creation_new:278] - Preenchendo Condição de Pagamento: 2
2025-10-01 09:52:28,461 - INFO - [test_dav_creation_new:93] - Diálogo opcional 'Atenção !' encontrado. Enviando tecla '{ENTER 2}'.
2025-10-01 09:52:35,797 - INFO - [test_dav_creation_new:288] - Acionando o botão 'Lança Itens'...
2025-10-01 09:52:40,055 - INFO - [test_dav_creation_new:292] - Selecionando a aba 'T - Itens'...
2025-10-01 09:52:47,383 - INFO - [test_dav_creation_new:298] - Iniciando lançamento de itens...
2025-10-01 09:52:47,383 - INFO - [test_dav_creation_new:302] - -> Lançando produto: 2291
2025-10-01 09:52:58,409 - INFO - [test_dav_creation_new:97] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-10-01 09:52:58,410 - INFO - [test_dav_creation_new:330] -    -> Estoque: 2, Fração Mínima: 0.0, Quantidade: 1
2025-10-01 09:53:05,777 - INFO - [test_dav_creation_new:109] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-10-01 09:53:09,057 - ERROR - [test_dav_creation_new:345] - Ocorreu um erro durante o teste de criação de DAV: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 1118292>, 'backend': 'uia'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 337, in run
    dav_window.child_window(**selectors['dav_gravar_item_button']).invoke()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 1118292>, 'backend': 'uia'}
2025-10-01 09:53:42,417 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 09:53:42,418 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:10:57,298 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:10:57,298 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:10:57,312 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:10:57,312 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:10:57,313 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:10:57,327 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:10:58,626 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:10:58,626 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:10:58,628 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:10:58,637 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:11:00,345 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:11:00,348 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:11:02,545 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:11:02,546 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:11:04,481 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:11:04,485 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:11:04,499 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:11:04,500 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:11:06,232 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:11:06,234 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:11:07,675 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:11:07,677 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:11:13,861 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:11:13,863 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:11:13,880 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:11:13,881 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:11:13,886 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:11:13,886 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:11:17,642 - INFO - [test_dav_creation_new:248] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:11:17,699 - INFO - [test_dav_creation_new:251] - Navegado para a seção 'Vendas'.
2025-10-01 10:11:25,350 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:11:25,350 - INFO - [test_dav_creation_new:262] - Preenchendo Natureza: VEE
2025-10-01 10:11:31,978 - INFO - [test_dav_creation_new:266] - Preenchendo Cliente: 2463
2025-10-01 10:11:39,398 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 10:11:39,990 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 10:11:39,990 - INFO - [test_dav_creation_new:273] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 10:11:39,990 - INFO - [test_dav_creation_new:276] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 10:11:43,962 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 10:11:44,554 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:11:44,554 - INFO - [test_dav_creation_new:288] - Preenchendo Forma de Pagamento: BL
2025-10-01 10:11:51,374 - INFO - [test_dav_creation_new:292] - Preenchendo Condição de Pagamento: 2
2025-10-01 10:12:01,562 - INFO - [test_dav_creation_new:303] - Acionando o botão 'Lança Itens'...
2025-10-01 10:12:05,877 - INFO - [test_dav_creation_new:307] - Selecionando a aba 'T - Itens'...
2025-10-01 10:12:13,336 - INFO - [test_dav_creation_new:313] - Iniciando lançamento de itens...
2025-10-01 10:12:13,336 - INFO - [test_dav_creation_new:317] - -> Lançando produto: 36
2025-10-01 10:12:16,803 - ERROR - [test_dav_creation_new:360] - Ocorreu um erro durante o teste de criação de DAV: 
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 320, in run
    set_text_safely(produto_field, product_code)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 19, in set_text_safely
    control.type_keys("^a{DELETE}", with_spaces=True)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\base_wrapper.py", line 937, in type_keys
    self.verify_actionable()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\base_wrapper.py", line 681, in verify_actionable
    self.verify_enabled()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\base_wrapper.py", line 692, in verify_enabled
    raise ElementNotEnabled()
pywinauto.base_wrapper.ElementNotEnabled
2025-10-01 10:12:19,242 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:12:19,242 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:14:07,053 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:14:07,053 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:14:07,066 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:14:07,067 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:14:07,067 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:14:07,080 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:14:08,754 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:14:08,754 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:14:08,756 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:14:08,761 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:14:10,106 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:14:10,116 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:14:12,402 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:14:12,404 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:14:14,179 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:14:14,183 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:14:14,196 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:14:14,198 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:14:15,444 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:14:15,851 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:14:17,408 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:14:17,945 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:14:30,377 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:14:30,380 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:14:30,387 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:14:30,388 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:14:30,397 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:14:30,398 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:14:34,219 - INFO - [test_dav_creation_new:248] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:14:34,273 - INFO - [test_dav_creation_new:251] - Navegado para a seção 'Vendas'.
2025-10-01 10:14:41,543 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:14:41,544 - INFO - [test_dav_creation_new:262] - Preenchendo Natureza: VEE
2025-10-01 10:14:48,040 - INFO - [test_dav_creation_new:266] - Preenchendo Cliente: 2463
2025-10-01 10:14:55,084 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 10:14:55,676 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 10:14:55,676 - INFO - [test_dav_creation_new:273] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 10:14:55,677 - INFO - [test_dav_creation_new:276] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 10:14:59,494 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 10:15:00,085 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:15:00,085 - INFO - [test_dav_creation_new:288] - Preenchendo Forma de Pagamento: BL
2025-10-01 10:15:06,693 - INFO - [test_dav_creation_new:292] - Preenchendo Condição de Pagamento: 2
2025-10-01 10:15:16,992 - INFO - [test_dav_creation_new:303] - Acionando o botão 'Lança Itens'...
2025-10-01 10:15:21,344 - INFO - [test_dav_creation_new:307] - Selecionando a aba 'T - Itens'...
2025-10-01 10:15:28,788 - INFO - [test_dav_creation_new:313] - Iniciando lançamento de itens...
2025-10-01 10:15:28,788 - INFO - [test_dav_creation_new:317] - -> Lançando produto: 36
2025-10-01 10:15:39,433 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-10-01 10:15:39,433 - INFO - [test_dav_creation_new:345] -    -> Estoque: 2, Fração Mínima: 0.0, Quantidade: 1
2025-10-01 10:15:46,624 - INFO - [test_dav_creation_new:123] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-10-01 10:15:49,844 - ERROR - [test_dav_creation_new:360] - Ocorreu um erro durante o teste de criação de DAV: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 2035802>, 'backend': 'uia'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 352, in run
    dav_window.child_window(**selectors['dav_gravar_item_button']).invoke()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 2035802>, 'backend': 'uia'}
2025-10-01 10:18:34,706 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:18:34,706 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:19:23,523 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:19:23,523 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:19:23,535 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:19:23,536 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:19:23,537 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:19:23,549 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:19:24,594 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:19:24,594 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:19:24,596 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:19:24,599 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:19:26,792 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:19:26,795 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:19:28,571 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:19:28,573 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:19:29,846 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:19:29,851 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:19:29,865 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:19:29,867 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:19:31,265 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:19:31,267 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:19:32,823 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:19:32,825 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:19:36,297 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:19:36,300 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:19:36,315 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:19:36,316 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:19:36,321 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:19:36,321 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:19:40,357 - INFO - [test_dav_creation_new:248] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:19:40,412 - INFO - [test_dav_creation_new:251] - Navegado para a seção 'Vendas'.
2025-10-01 10:19:47,770 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:19:47,771 - INFO - [test_dav_creation_new:262] - Preenchendo Natureza: VEE
2025-10-01 10:19:54,396 - INFO - [test_dav_creation_new:266] - Preenchendo Cliente: 2463
2025-10-01 10:20:01,502 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 10:20:02,094 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 10:20:02,094 - INFO - [test_dav_creation_new:273] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 10:20:02,095 - INFO - [test_dav_creation_new:276] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 10:20:06,043 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 10:20:06,634 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:20:06,634 - INFO - [test_dav_creation_new:288] - Preenchendo Forma de Pagamento: BL
2025-10-01 10:20:13,412 - INFO - [test_dav_creation_new:292] - Preenchendo Condição de Pagamento: 2
2025-10-01 10:20:23,841 - INFO - [test_dav_creation_new:303] - Acionando o botão 'Lança Itens'...
2025-10-01 10:20:28,067 - INFO - [test_dav_creation_new:307] - Selecionando a aba 'T - Itens'...
2025-10-01 10:20:35,220 - INFO - [test_dav_creation_new:313] - Iniciando lançamento de itens...
2025-10-01 10:20:35,221 - INFO - [test_dav_creation_new:317] - -> Lançando produto: 36
2025-10-01 10:20:42,082 - INFO - [test_dav_creation_new:324] - Produto tem 2 unidade(s) mapeada(s).
2025-10-01 10:20:45,778 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-10-01 10:20:45,778 - INFO - [test_dav_creation_new:352] -    -> Estoque: 2, Fração Mínima: 0.0, Quantidade: 1
2025-10-01 10:20:52,914 - INFO - [test_dav_creation_new:123] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-10-01 10:20:56,118 - ERROR - [test_dav_creation_new:367] - Ocorreu um erro durante o teste de criação de DAV: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 3543134>, 'backend': 'uia'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 359, in run
    dav_window.child_window(**selectors['dav_gravar_item_button']).invoke()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 3543134>, 'backend': 'uia'}
2025-10-01 10:21:00,538 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:21:00,538 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:23:02,202 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:23:02,203 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:23:02,215 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:23:02,216 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:23:02,216 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:23:02,247 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:23:03,754 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:23:03,754 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:23:03,757 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:23:03,767 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:23:05,257 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:23:05,264 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:23:07,559 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:23:07,562 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:23:10,306 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:23:10,308 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:23:10,313 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:23:10,314 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:23:17,838 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:23:17,840 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:23:19,529 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:23:19,531 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:23:24,833 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:23:24,834 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:23:24,838 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:23:24,839 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:23:24,842 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:23:24,843 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:23:28,903 - INFO - [test_dav_creation_new:248] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:23:28,948 - INFO - [test_dav_creation_new:251] - Navegado para a seção 'Vendas'.
2025-10-01 10:23:36,220 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:23:36,221 - INFO - [test_dav_creation_new:262] - Preenchendo Natureza: VEE
2025-10-01 10:23:42,917 - INFO - [test_dav_creation_new:266] - Preenchendo Cliente: 2463
2025-10-01 10:23:50,076 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 10:23:50,668 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 10:23:50,668 - INFO - [test_dav_creation_new:273] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 10:23:50,668 - INFO - [test_dav_creation_new:276] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 10:23:54,455 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 10:23:55,046 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:23:55,046 - INFO - [test_dav_creation_new:288] - Preenchendo Forma de Pagamento: BL
2025-10-01 10:24:01,580 - INFO - [test_dav_creation_new:292] - Preenchendo Condição de Pagamento: 2
2025-10-01 10:24:12,131 - INFO - [test_dav_creation_new:303] - Acionando o botão 'Lança Itens'...
2025-10-01 10:24:16,225 - INFO - [test_dav_creation_new:307] - Selecionando a aba 'T - Itens'...
2025-10-01 10:24:23,612 - INFO - [test_dav_creation_new:313] - Iniciando lançamento de itens...
2025-10-01 10:24:23,612 - INFO - [test_dav_creation_new:317] - -> Lançando produto: 36
2025-10-01 10:24:33,423 - INFO - [test_dav_creation_new:326] - Produto tem 2 unidade(s) mapeada(s).
2025-10-01 10:24:38,003 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Último preço praticado' não apareceu. Prosseguindo...
2025-10-01 10:24:38,003 - INFO - [test_dav_creation_new:354] -    -> Estoque: 2, Fração Mínima: 0.0, Quantidade: 1
2025-10-01 10:24:45,484 - INFO - [test_dav_creation_new:123] - Pré-verificação (win32): Janela de autorização não apareceu no tempo esperado.
2025-10-01 10:24:48,656 - ERROR - [test_dav_creation_new:369] - Ocorreu um erro durante o teste de criação de DAV: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 4198156>, 'backend': 'uia'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 361, in run
    dav_window.child_window(**selectors['dav_gravar_item_button']).invoke()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 98, in find_element
    raise exception
pywinauto.findwindows.ElementAmbiguousError: There are 3 elements that match the criteria {'title': 'Gravar', 'control_type': 'Button', 'top_level_only': False, 'parent': <uia_element_info.UIAElementInfo - 'Documento Auxiliar de Venda - Inclusão ', 2.53_19c000000, 4198156>, 'backend': 'uia'}
2025-10-01 10:40:11,315 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:40:11,315 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:40:20,657 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:40:20,657 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:40:20,670 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:40:20,670 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:40:20,671 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:40:20,685 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:40:22,122 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:40:22,123 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:40:22,125 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:40:22,133 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:40:23,640 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:40:23,643 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:40:25,394 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:40:25,396 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:40:26,866 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:40:26,867 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:40:26,872 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:40:26,873 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:40:28,195 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:40:28,213 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:40:29,822 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:40:29,824 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:40:34,302 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:40:34,304 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:40:34,311 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:40:34,312 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:40:34,316 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:40:34,316 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:40:38,286 - INFO - [test_dav_creation_new:250] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:40:38,300 - ERROR - [test_dav_creation_new:383] - Ocorreu um erro durante o teste de criação de DAV: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 252, in run
    main_window_win32.type_keys('%V{ENTER}', fast=True)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
2025-10-01 10:40:45,075 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:40:45,075 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:40:45,077 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:40:45,081 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:40:47,328 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:40:47,330 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:40:49,561 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:40:49,564 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:40:51,008 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:40:51,010 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:40:51,017 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:40:51,019 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:40:52,105 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:40:52,107 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:40:53,345 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:40:53,347 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:40:56,603 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:40:56,606 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:40:56,613 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:40:56,614 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:40:56,618 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:40:56,619 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:41:00,342 - INFO - [test_dav_creation_new:250] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:41:00,354 - ERROR - [test_dav_creation_new:383] - Ocorreu um erro durante o teste de criação de DAV: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 252, in run
    main_window_win32.type_keys('%V{ENTER}', fast=True)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
2025-10-01 10:42:16,171 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:42:16,171 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:42:17,836 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:42:17,837 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:42:17,850 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:42:17,850 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:42:17,851 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:42:17,863 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:42:18,891 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:42:18,892 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:42:18,894 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:42:18,901 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:42:20,095 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:42:20,098 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:42:21,656 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:42:21,658 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:42:23,432 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:42:23,435 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:42:23,442 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:42:23,443 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:42:27,489 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:42:27,491 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:42:28,855 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:42:28,862 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:42:31,888 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:42:31,890 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:42:31,894 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:42:31,895 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:42:31,897 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:42:31,897 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:42:35,620 - INFO - [test_dav_creation_new:249] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:42:35,681 - INFO - [test_dav_creation_new:252] - Navegado para a seção 'Vendas'.
2025-10-01 10:42:42,955 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:42:42,955 - INFO - [test_dav_creation_new:263] - Preenchendo Natureza: VEE
2025-10-01 10:42:49,295 - ERROR - [test_dav_creation_new:382] - Ocorreu um erro durante o teste de criação de DAV: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 265, in run
    set_text_safely(natop_field, cod_natureza)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 20, in set_text_safely
    control.type_keys(text,fast=True, with_spaces=True)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: BaseWrapper.type_keys() got an unexpected keyword argument 'fast'
2025-10-01 10:47:48,515 - INFO - [db_handler:426] - Fechando pool de conexões com o MySQL.
2025-10-01 10:47:48,516 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-10-01 10:47:56,570 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-10-01 10:47:56,570 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-10-01 10:47:56,583 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-10-01 10:47:56,584 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-10-01 10:47:56,585 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-10-01 10:47:56,595 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.29:3306 criado com sucesso.
2025-10-01 10:47:58,131 - INFO - [test_dav_creation_new:154] - ### INICIANDO TESTE REATORADO: Criação de DAV com Foco Direto ###
2025-10-01 10:47:58,131 - INFO - [test_dav_creation_new:158] - --- FASE 1: Coletando todas as informações necessárias ---
2025-10-01 10:47:58,134 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-10-01 10:47:58,143 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-10-01 10:47:59,896 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 1
2025-10-01 10:47:59,909 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-10-01 10:48:01,944 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: VEE
2025-10-01 10:48:01,946 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente, c.cli_limitecre AS Credito...
2025-10-01 10:48:03,738 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2463
2025-10-01 10:48:03,741 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-10-01 10:48:03,745 - INFO - [test_dav_creation_new:183] - Valor de Nat_cfgvendedor encontrado: 1
2025-10-01 10:48:03,746 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as formas de pagamento específicas SE o cliente tiver alguma restrição cadastrada...
2025-10-01 10:48:04,888 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: BL
2025-10-01 10:48:04,890 - INFO - [db_handler:37] - Executando query: -- Parte 1: Busca as condições específicas do cliente, se houver...
2025-10-01 10:48:06,680 - INFO - [test_dav_creation_new:42] - Usuário selecionou o código: 2
2025-10-01 10:48:06,687 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-10-01 10:48:11,673 - INFO - [test_dav_creation_new:77] - Usuário selecionou 1 itens: ['36']
2025-10-01 10:48:11,676 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:48:11,684 - INFO - [test_dav_creation_new:228] - Buscando dados de fração mínima para os produtos selecionados...
2025-10-01 10:48:11,686 - INFO - [db_handler:37] - Executando query: SELECT...
2025-10-01 10:48:11,695 - INFO - [test_dav_creation_new:237] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-10-01 10:48:11,695 - INFO - [test_dav_creation_new:240] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-10-01 10:48:15,641 - INFO - [test_dav_creation_new:250] - Conexões com backends 'win32' e 'uia' estabelecidas.
2025-10-01 10:48:15,678 - INFO - [test_dav_creation_new:253] - Navegado para a seção 'Vendas'.
2025-10-01 10:48:22,833 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:48:22,833 - INFO - [test_dav_creation_new:264] - Preenchendo Natureza: VEE
2025-10-01 10:48:29,148 - INFO - [test_dav_creation_new:268] - Preenchendo Cliente: 2463
2025-10-01 10:48:36,103 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-10-01 10:48:36,604 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-10-01 10:48:36,605 - INFO - [test_dav_creation_new:275] - Aplicando regra de automação para CfgVendedor = 1
2025-10-01 10:48:36,605 - INFO - [test_dav_creation_new:278] - -> CfgVendedor = 1. Pressionando ENTER para acionar a seleção padrão de vendedor.
2025-10-01 10:48:40,243 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Selecione o Vendedor' não apareceu. Prosseguindo...
2025-10-01 10:48:40,744 - INFO - [test_dav_creation_new:111] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-10-01 10:48:40,744 - INFO - [test_dav_creation_new:290] - Preenchendo Forma de Pagamento: BL
2025-10-01 10:48:46,778 - INFO - [test_dav_creation_new:294] - Preenchendo Condição de Pagamento: 2
2025-10-01 10:48:56,757 - INFO - [test_dav_creation_new:305] - Acionando o botão 'Lança Itens'...
2025-10-01 10:49:00,748 - INFO - [test_dav_creation_new:309] - Selecionando a aba 'T - Itens'...
2025-10-01 10:49:11,079 - INFO - [test_dav_creation_new:318] - Iniciando lançamento de itens...
2025-10-01 10:49:11,080 - INFO - [test_dav_creation_new:321] - Acionando o botão 'Incluir' para uma nova linha de item...
2025-10-01 10:49:11,080 - ERROR - [test_dav_creation_new:383] - Ocorreu um erro durante o teste de criação de DAV: 'dav_incluir_item_button'
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation_new.py", line 323, in run
    itens_tab.child_window(**selectors['dav_incluir_item_button']).invoke()
                             ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'dav_incluir_item_button'
