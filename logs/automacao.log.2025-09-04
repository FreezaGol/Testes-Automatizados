2025-09-04 16:36:29,540 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-04 16:36:29,541 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-04 16:36:29,562 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-04 16:36:29,562 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-04 16:36:29,563 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-04 16:36:29,600 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-04 16:36:31,695 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:36:31,695 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:36:31,698 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:36:31,702 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:36:31,703 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:36:33,945 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:36:33,945 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:36:33,946 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:36:37,877 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:36:37,880 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:36:41,317 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-04 16:36:41,318 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:36:41,322 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:36:43,154 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-04 16:36:43,158 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:36:44,525 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:36:44,527 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:36:45,800 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:36:45,955 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:37:01,393 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['2', '4', '9', '11']
2025-09-04 16:37:01,396 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:37:01,402 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:37:01,402 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:37:04,402 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:37:04,410 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:37:04,690 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:37:04,709 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:37:04,709 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:37:05,444 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:37:06,460 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:37:06,460 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:37:06,713 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:37:06,714 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:37:06,715 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:37:06,718 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:37:06,733 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:37:06,970 - INFO - [test_dav_creation:290] -    -> Cliente '69365' inserido.
2025-09-04 16:37:08,077 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-04 16:37:08,082 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-04 16:37:08,100 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:37:09,192 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:37:09,198 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:37:09,198 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:37:09,198 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:37:09,539 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-04 16:37:10,631 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:37:10,631 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:37:10,734 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:37:10,734 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:37:10,751 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:37:11,009 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:37:11,009 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:37:11,066 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:37:11,566 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:37:11,567 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:37:11,573 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:37:11,574 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:37:11,574 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:37:11,574 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:37:11,592 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:37:11,596 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:37:11,827 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:37:12,128 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 6
2025-09-04 16:37:12,381 - INFO - [test_dav_creation:441] - Verificando se a janela de autorização apareceu...
2025-09-04 16:37:12,381 - ERROR - [test_dav_creation:493] - Ocorreu um erro durante o teste de criação de DAV: 'authorization_dialog'
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 442, in run
    _handle_authorization_dialog(main_window, selectors['authorization_dialog'], "{TAB}{ENTER}")
                                              ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: 'authorization_dialog'
2025-09-04 16:37:34,055 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-04 16:37:34,055 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-04 16:38:08,497 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-04 16:38:08,497 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-04 16:38:08,524 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-04 16:38:08,524 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-04 16:38:08,525 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-04 16:38:08,531 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-04 16:38:10,215 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:38:10,215 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:38:10,216 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:38:10,220 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:38:10,221 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:38:12,932 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:38:12,932 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:38:12,934 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:38:47,149 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:38:47,151 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:38:53,882 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 69365
2025-09-04 16:38:53,890 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:38:53,900 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:38:55,521 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-04 16:38:55,527 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:38:56,574 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:38:56,575 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:38:57,599 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:38:57,600 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:39:16,384 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['2', '8', '9', '10']
2025-09-04 16:39:16,387 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:39:16,393 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:39:16,393 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:39:19,393 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:39:19,407 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:39:19,627 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:39:19,648 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:39:19,648 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:39:20,363 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:39:21,380 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:39:21,380 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:39:21,760 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:39:21,761 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:39:21,763 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:39:21,766 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:39:21,782 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:39:22,010 - INFO - [test_dav_creation:290] -    -> Cliente '69365' inserido.
2025-09-04 16:39:23,028 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-04 16:39:23,034 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-04 16:39:23,051 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:39:24,146 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:39:24,146 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:39:24,146 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:39:24,146 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:39:24,426 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-04 16:39:25,517 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:39:25,517 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:39:25,623 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:39:25,624 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:39:25,639 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:39:25,916 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:39:25,916 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:39:25,974 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:39:26,474 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:39:26,475 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:39:26,478 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:39:26,478 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:39:26,478 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:39:26,478 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:39:26,497 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:26,500 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:39:26,733 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:39:27,032 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 18
2025-09-04 16:39:27,296 - INFO - [test_dav_creation:441] - Verificando se a janela de autorização apareceu...
2025-09-04 16:39:30,516 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:39:30,517 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:30,520 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:31,095 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:39:42,233 - INFO - [test_dav_creation:475] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:39:42,816 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-04 16:39:42,835 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:39:42,835 - INFO - [test_dav_creation:390] -    -> Lançando produto: 8
2025-09-04 16:39:43,231 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:43,234 - INFO - [test_dav_creation:407] - Produto tem 1 unidade(s) mapeada(s).
2025-09-04 16:39:43,455 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:39:43,868 - INFO - [test_dav_creation:435] - Estoque disponível: 484. Quantidade sorteada: 10
2025-09-04 16:39:44,130 - INFO - [test_dav_creation:441] - Verificando se a janela de autorização apareceu...
2025-09-04 16:39:47,207 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:39:47,207 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:47,211 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:47,788 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:39:55,640 - INFO - [test_dav_creation:475] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:39:56,853 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:39:56,853 - INFO - [test_dav_creation:390] -    -> Lançando produto: 9
2025-09-04 16:39:56,990 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:39:56,993 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:39:57,225 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:39:57,530 - INFO - [test_dav_creation:435] - Estoque disponível: 29. Quantidade sorteada: 13
2025-09-04 16:39:57,819 - INFO - [test_dav_creation:441] - Verificando se a janela de autorização apareceu...
2025-09-04 16:40:00,865 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:40:00,866 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:40:00,868 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:40:01,442 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:42:18,835 - ERROR - [test_dav_creation:493] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 8852892>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 474, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 8852892>, 'backend': 'win32'}
2025-09-04 16:42:20,991 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-04 16:42:20,991 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-04 16:42:23,602 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-04 16:42:23,602 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-04 16:42:23,620 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-04 16:42:23,620 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-04 16:42:23,621 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-04 16:42:23,640 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-04 16:42:24,942 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:42:24,942 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:42:24,943 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:42:24,946 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:42:24,947 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:42:27,007 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:42:27,008 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:42:27,009 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:42:29,991 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:42:29,992 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:42:32,785 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-04 16:42:32,808 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:42:32,824 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:42:34,842 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-04 16:42:34,843 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:42:36,156 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:42:36,235 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:42:37,874 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:42:37,886 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:42:48,374 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['2', '7', '9', '11']
2025-09-04 16:42:48,377 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:42:48,391 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:42:48,391 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:42:51,392 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:42:51,398 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:42:51,610 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:42:51,627 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:42:51,628 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:42:52,217 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:42:53,234 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:42:53,234 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:42:53,586 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:42:53,586 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:42:53,587 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:42:53,591 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:42:53,605 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:42:53,848 - INFO - [test_dav_creation:290] -    -> Cliente '65820' inserido.
2025-09-04 16:42:54,862 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-04 16:42:55,864 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:42:56,913 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:42:56,914 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:42:56,914 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:42:56,914 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:42:57,020 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-04 16:42:58,020 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:42:58,020 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:42:58,120 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:42:58,120 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:42:58,138 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:42:58,390 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:42:58,390 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:42:58,447 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:42:58,947 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:42:58,949 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:42:58,952 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:42:58,952 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:42:58,952 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:42:58,952 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:42:58,972 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:42:58,977 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:42:59,213 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:42:59,514 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 1
2025-09-04 16:42:59,781 - INFO - [test_dav_creation:442] - Verificando se a janela de autorização apareceu...
2025-09-04 16:43:02,971 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:43:02,972 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:43:02,976 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:43:03,543 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:43:12,175 - INFO - [test_dav_creation:475] - Pressionando ENTER para gravar o item.
2025-09-04 16:43:13,475 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:43:13,475 - INFO - [test_dav_creation:390] -    -> Lançando produto: 7
2025-09-04 16:43:13,490 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:43:13,493 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:43:13,724 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:43:14,558 - INFO - [test_dav_creation:435] - Estoque disponível: 24. Quantidade sorteada: 8
2025-09-04 16:43:14,942 - INFO - [test_dav_creation:442] - Verificando se a janela de autorização apareceu...
2025-09-04 16:43:18,034 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:43:18,047 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:43:18,050 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:43:18,618 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:48:21,221 - ERROR - [test_dav_creation:493] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 8852892>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 474, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 8852892>, 'backend': 'win32'}
2025-09-04 16:48:22,990 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-04 16:48:22,991 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-04 16:48:25,736 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-04 16:48:25,736 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-04 16:48:25,755 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-04 16:48:25,755 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-04 16:48:25,756 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-04 16:48:25,764 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-04 16:48:26,967 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:48:26,967 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:48:26,968 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:48:26,971 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:48:26,972 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:48:28,918 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:48:28,918 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:48:28,921 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:48:30,669 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:48:30,670 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:48:32,288 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-04 16:48:32,300 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:48:32,305 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:48:33,977 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 850
2025-09-04 16:48:33,978 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:48:34,917 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:48:34,918 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:48:35,679 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:48:35,680 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:48:46,712 - INFO - [test_dav_creation:98] - Usuário selecionou 4 itens: ['2', '7', '8', '9']
2025-09-04 16:48:46,732 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:48:46,737 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:48:46,738 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:48:49,738 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:48:49,747 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:48:49,959 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:48:49,976 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:48:49,977 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:48:50,584 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:48:51,602 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:48:51,602 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:48:51,858 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:48:51,858 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:48:51,859 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:48:51,862 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:48:51,875 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:48:52,121 - INFO - [test_dav_creation:290] -    -> Cliente '65820' inserido.
2025-09-04 16:48:53,229 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-04 16:48:54,322 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:48:55,324 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:48:55,324 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:48:55,324 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:48:55,324 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:48:55,433 - INFO - [test_dav_creation:328] -    -> Vendedor '850' inserido.
2025-09-04 16:48:56,435 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:48:56,435 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:48:56,540 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:48:56,540 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:48:56,556 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:48:56,756 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:48:56,756 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:48:56,814 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:48:57,314 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:48:57,315 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:48:57,318 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:48:57,318 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:48:57,318 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:48:57,319 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:48:57,342 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:48:57,344 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:48:57,577 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:48:58,226 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 3
2025-09-04 16:48:58,494 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:48:58,498 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:48:59,019 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:49:02,174 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:49:02,233 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:50:44,667 - ERROR - [test_dav_creation:493] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 19666716>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 474, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 19666716>, 'backend': 'win32'}
2025-09-04 16:50:56,030 - INFO - [db_handler:366] - Fechando pool de conexões com o MySQL.
2025-09-04 16:50:56,030 - INFO - [main:74] - ================ FINALIZANDO EXECUÇÃO ================

2025-09-04 16:51:09,695 - INFO - [logger_config:30] - Logger configurado com sucesso.
2025-09-04 16:51:09,695 - INFO - [main:43] - ================ INICIANDO TEST RUNNER ================
2025-09-04 16:51:09,714 - INFO - [authentication:66] - package: mysql.connector.plugins
2025-09-04 16:51:09,714 - INFO - [authentication:67] - plugin_name: mysql_native_password
2025-09-04 16:51:09,715 - INFO - [authentication:71] - AUTHENTICATION_PLUGIN_CLASS: MySQLNativePasswordAuthPlugin
2025-09-04 16:51:09,722 - INFO - [db_handler:26] - Pool de conexões com MySQL para 192.168.0.7:3306 criado com sucesso.
2025-09-04 16:51:11,054 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:51:11,054 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:51:11,055 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:51:11,058 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:51:11,058 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:51:12,513 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:51:12,513 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:51:12,527 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:51:14,437 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:51:14,438 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:51:16,509 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 65820
2025-09-04 16:51:16,511 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:51:16,517 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:51:18,856 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-04 16:51:18,857 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:51:19,855 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:51:20,150 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:51:21,080 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:51:21,082 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:51:35,641 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['2', '9', '10']
2025-09-04 16:51:35,643 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:51:35,649 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:51:35,649 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:51:38,650 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:51:38,714 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:51:38,935 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:51:38,961 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:51:38,961 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:51:39,683 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:51:40,716 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:51:40,716 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:51:40,977 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:51:40,977 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:51:40,979 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:51:40,982 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:51:41,001 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:51:41,322 - INFO - [test_dav_creation:290] -    -> Cliente '65820' inserido.
2025-09-04 16:51:42,358 - INFO - [test_dav_creation:130] - Diálogo opcional 'Advertência' não apareceu. Prosseguindo...
2025-09-04 16:51:43,368 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:51:44,459 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:51:44,460 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:51:44,460 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:51:44,460 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:51:44,580 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-04 16:51:45,587 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:51:45,587 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:51:45,704 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:51:45,704 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:51:45,730 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:51:46,063 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:51:46,063 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:51:46,131 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:51:46,631 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:51:46,632 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:51:46,635 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:51:46,635 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:51:46,635 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:51:46,635 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:51:46,710 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:51:46,713 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:51:46,956 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:51:47,274 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 15
2025-09-04 16:51:47,601 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:51:47,604 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:51:48,132 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:51:51,223 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:51:51,786 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:51:59,213 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:52:00,435 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:52:00,435 - INFO - [test_dav_creation:390] -    -> Lançando produto: 9
2025-09-04 16:52:00,537 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:00,565 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:52:00,809 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:52:01,140 - INFO - [test_dav_creation:435] - Estoque disponível: 29. Quantidade sorteada: 2
2025-09-04 16:52:01,402 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:01,405 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:01,933 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:52:05,025 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:52:05,621 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:52:16,081 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:52:16,557 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-04 16:52:16,590 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:52:16,591 - INFO - [test_dav_creation:390] -    -> Lançando produto: 10
2025-09-04 16:52:16,884 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:16,944 - INFO - [test_dav_creation:407] - Produto tem 1 unidade(s) mapeada(s).
2025-09-04 16:52:17,455 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:52:17,825 - INFO - [test_dav_creation:435] - Estoque disponível: 208. Quantidade sorteada: 12
2025-09-04 16:52:18,103 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:18,106 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:52:18,635 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:52:21,674 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:52:22,356 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:52:28,954 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:52:30,230 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:52:30,231 - INFO - [test_dav_creation:490] - Todos os itens selecionados foram lançados com sucesso.
2025-09-04 16:52:30,231 - INFO - [test_dav_creation:491] - ### TESTE CONCLUÍDO: Criação de DAV ###
2025-09-04 16:53:34,198 - INFO - [test_dav_creation:165] - ### INICIANDO TESTE: Criação de Documento Auxiliar de Venda (DAV) ###
2025-09-04 16:53:34,198 - INFO - [test_dav_creation:171] - --- FASE 1: Coletando todas as informações necessárias ---
2025-09-04 16:53:34,205 - INFO - [db_handler:37] - Executando query: SELECT COUNT(*) AS total_de_filiais_ativas FROM filial WHERE FIL_ATIVO = 1;...
2025-09-04 16:53:34,226 - INFO - [test_dav_creation:177] - Múltiplas filiais ativas encontradas. Solicitando seleção do usuário.
2025-09-04 16:53:34,228 - INFO - [db_handler:37] - Executando query: SELECT FIL_CODIGO as codigo_filial, FIL_RAZAO as nome_filial FROM filial WHERE FIL_ATIVO = 1 ORDER BY FIL_RAZAO;...
2025-09-04 16:53:36,357 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 4
2025-09-04 16:53:36,358 - INFO - [test_dav_creation:181] - Trabalhando com a filial: 4
2025-09-04 16:53:36,360 - INFO - [db_handler:37] - Executando query: SELECT n.Nat_Codigo AS codigo_natureza, n.Nat_Desc AS descricao...
2025-09-04 16:53:39,223 - INFO - [test_dav_creation:47] - Usuário selecionou o código: VIN
2025-09-04 16:53:39,224 - INFO - [db_handler:37] - Executando query: SELECT p.PES_CODIGO AS codigo_cliente, p.pes_razao AS nome_cliente...
2025-09-04 16:53:41,983 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 379
2025-09-04 16:53:41,986 - INFO - [db_handler:37] - Executando query: SELECT Nat_cfgvendedor FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:53:41,993 - INFO - [db_handler:37] - Executando query: SELECT c.CLB_CODIGO AS codigo_colaborador, c.CLB_RAZAO AS nome_vendedor...
2025-09-04 16:53:43,901 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 504
2025-09-04 16:53:43,902 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT fp.FPG_CODIGO AS codigo_forma, fp.FPG_DESC AS descricao...
2025-09-04 16:53:45,689 - INFO - [test_dav_creation:47] - Usuário selecionou o código: DH
2025-09-04 16:53:45,690 - INFO - [db_handler:37] - Executando query: SELECT DISTINCT cp.CPG_CODIGO as codigo_condicao, cp.CPG_DESC AS descricao...
2025-09-04 16:53:46,492 - INFO - [test_dav_creation:47] - Usuário selecionou o código: 113
2025-09-04 16:53:46,496 - INFO - [db_handler:37] - Executando query: SELECT pro_desc AS nome_produto,...
2025-09-04 16:54:08,171 - INFO - [test_dav_creation:98] - Usuário selecionou 3 itens: ['2', '9', '15']
2025-09-04 16:54:08,175 - INFO - [db_handler:37] - Executando query: SELECT...
2025-09-04 16:54:08,186 - INFO - [test_dav_creation:236] - --- FASE 1 CONCLUÍDA: Todos os dados foram coletados. ---
2025-09-04 16:54:08,186 - INFO - [test_dav_creation:237] - A automação da interface começará em 3 segundos...
2025-09-04 16:54:11,187 - INFO - [test_dav_creation:243] - --- FASE 2: Iniciando automação da interface do Guardian ---
2025-09-04 16:54:11,261 - INFO - [test_dav_creation:248] - Janela principal do Guardian encontrada e pronta para automação.
2025-09-04 16:54:11,480 - INFO - [test_dav_creation:253] - Passo 3: Navegado para a seção 'Vendas'.
2025-09-04 16:54:11,504 - INFO - [test_dav_creation:257] - Passo 4: Tela de inclusão de DAV aberta.
2025-09-04 16:54:11,504 - INFO - [test_dav_creation:260] - Passo 5: Procurando pela janela filha de Inclusão de DAV...
2025-09-04 16:54:12,291 - INFO - [test_dav_creation:264] -    -> Janela de Inclusão de DAV encontrada. Pressionando F2...
2025-09-04 16:54:13,318 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:54:13,318 - INFO - [test_dav_creation:271] - Passo 6: Inserindo Natureza de Operação pré-selecionada...
2025-09-04 16:54:13,763 - INFO - [test_dav_creation:274] -    -> Natureza 'VIN' inserida.
2025-09-04 16:54:13,764 - INFO - [test_dav_creation:277] - Passo 7: Verificando Nat_DatEmisPed...
2025-09-04 16:54:13,765 - INFO - [db_handler:37] - Executando query: SELECT Nat_DatEmisPed FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:54:13,767 - INFO - [test_dav_creation:283] -    -> Nat_DatEmisPed != 1. Pressionando ENTER 2x.
2025-09-04 16:54:13,788 - INFO - [test_dav_creation:287] - Passo 8: Inserindo Cliente pré-selecionado...
2025-09-04 16:54:14,015 - INFO - [test_dav_creation:290] -    -> Cliente '379' inserido.
2025-09-04 16:54:14,103 - INFO - [test_dav_creation:122] - Diálogo 'Advertência' encontrado.
2025-09-04 16:54:14,130 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:54:14,220 - INFO - [test_dav_creation:122] - Diálogo 'Atenção' encontrado.
2025-09-04 16:54:14,251 - INFO - [test_dav_creation:126] - --> Combinação de teclas '{ENTER}' enviada com sucesso.
2025-09-04 16:54:15,294 - INFO - [test_dav_creation:312] - Tela de endereços não foi encontrada script continua
2025-09-04 16:54:15,294 - INFO - [test_dav_creation:315] - Passo 9: Verificando configuração do vendedor...
2025-09-04 16:54:15,294 - INFO - [test_dav_creation:316] -    -> Valor de Nat_cfgvendedor: 3
2025-09-04 16:54:15,294 - INFO - [test_dav_creation:324] -    -> CfgVendedor = 3. Inserindo Vendedor pré-selecionado...
2025-09-04 16:54:15,581 - INFO - [test_dav_creation:328] -    -> Vendedor '504' inserido.
2025-09-04 16:54:16,825 - INFO - [test_dav_creation:130] - Diálogo opcional 'Confirmação' não apareceu. Prosseguindo...
2025-09-04 16:54:16,825 - INFO - [test_dav_creation:350] - Passo 12: Inserindo Forma de Pagamento pré-selecionada...
2025-09-04 16:54:16,942 - INFO - [test_dav_creation:354] -    -> Forma de pagamento 'DH' inserida.
2025-09-04 16:54:16,943 - INFO - [test_dav_creation:357] - Passo 13: Pressionando ENTER.
2025-09-04 16:54:16,964 - INFO - [test_dav_creation:361] - Passo 14: Inserindo Condição de Pagamento pré-selecionada...
2025-09-04 16:54:17,205 - INFO - [test_dav_creation:364] -    -> Condição de pagamento '113' inserida.
2025-09-04 16:54:17,205 - INFO - [test_dav_creation:367] - Passo 15: Pressionando ENTER 5x para lançar os itens.
2025-09-04 16:54:17,319 - INFO - [test_dav_creation:369] - Processo de preenchimento inicial do DAV finalizado com sucesso!
2025-09-04 16:54:17,819 - INFO - [test_dav_creation:372] - Passo 16: Verificando a existencia da caixa de diálogo Aliquota de Comissão 
2025-09-04 16:54:17,820 - INFO - [db_handler:37] - Executando query: SELECT pa5_digcomisDav FROM parametro5 WHERE pa5_filcodigo = %s...
2025-09-04 16:54:17,823 - INFO - [test_dav_creation:383] - Sistema não permite lançar comissão no DAV pulando para o proximo passo
2025-09-04 16:54:17,823 - INFO - [test_dav_creation:386] - Passo 17: Iniciando lançamento de itens...
2025-09-04 16:54:17,823 - INFO - [test_dav_creation:387] - Iniciando loop para lançar os produtos na tela de DAV...
2025-09-04 16:54:17,823 - INFO - [test_dav_creation:390] -    -> Lançando produto: 2
2025-09-04 16:54:17,851 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:17,854 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:54:18,093 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:54:18,433 - INFO - [test_dav_creation:435] - Estoque disponível: 545. Quantidade sorteada: 4
2025-09-04 16:54:18,701 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:18,709 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:19,240 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:54:22,262 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:54:22,824 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 16:54:30,174 - INFO - [test_dav_creation:476] - Pressionando ENTER 2x para gravar o item.
2025-09-04 16:54:31,386 - INFO - [test_dav_creation:130] - Diálogo opcional 'Atenção' não apareceu. Prosseguindo...
2025-09-04 16:54:31,386 - INFO - [test_dav_creation:390] -    -> Lançando produto: 9
2025-09-04 16:54:31,405 - INFO - [db_handler:37] - Executando query: SELECT pa2_vultpreco FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:31,424 - INFO - [test_dav_creation:407] - Produto tem 2 unidade(s) mapeada(s).
2025-09-04 16:54:31,660 - INFO - [db_handler:37] - Executando query: SELECT Nat_LcLtPeds FROM natoper WHERE Nat_Codigo = %s...
2025-09-04 16:54:32,098 - INFO - [test_dav_creation:435] - Estoque disponível: 29. Quantidade sorteada: 19
2025-09-04 16:54:32,374 - INFO - [db_handler:37] - Executando query: SELECT pa2_infacreped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:32,377 - INFO - [db_handler:37] - Executando query: SELECT pa2_infdescped FROM parametro2 WHERE pa2_filcodigo = %s...
2025-09-04 16:54:32,902 - INFO - [test_dav_creation:458] - Verificando se a janela de autorização apareceu...
2025-09-04 16:54:36,113 - INFO - [test_dav_creation:155] - Janela de autorização não apareceu. Prosseguindo...
2025-09-04 16:54:36,845 - INFO - [db_handler:37] - Executando query: SELECT pa4_tipoentit FROM parametro4 WHERE pa4_filcodigo = %s...
2025-09-04 17:01:08,466 - ERROR - [test_dav_creation:494] - Ocorreu um erro durante o teste de criação de DAV: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91624858>, 'backend': 'win32'}
Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 250, in __resolve_control
    ctrl = wait_until_passes(
        timeout,
    ...<5 lines>...
         controls.InvalidElement),
        criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 458, in wait_until_passes
    raise err
pywinauto.timings.TimeoutError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Space\Testes-Automatizados\src\tests\test_dav_creation.py", line 475, in run
    dav_window.set_focus()
    ^^^^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 379, in __getattribute__
    ctrls = self.__resolve_control(self.criteria)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 261, in __resolve_control
    raise e.original_exception
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\timings.py", line 436, in wait_until_passes
    func_val = func(*args, **kwargs)
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\application.py", line 222, in __get_ctrl
    ctrl = self.backend.generic_wrapper_class(findwindows.find_element(**ctrl_criteria))
                                              ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Space\Testes-Automatizados\.venv\Lib\site-packages\pywinauto\findwindows.py", line 87, in find_element
    raise ElementNotFoundError(kwargs)
pywinauto.findwindows.ElementNotFoundError: {'title': 'Consulta de Pedidos - Documento Auxiliar de vendas', 'top_level_only': False, 'parent': <win32_element_info.HwndElementInfo - 'Space Guardian - Versão: 2.52.6 - Data: 28/08/2025', 2.52_16P9c000000, 91624858>, 'backend': 'win32'}
